<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analisi delle Strutture di Comunicazione - Test Italiano</title>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 10px auto 20px auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 20px;
            text-align: center;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 999;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            margin: 0;
            font-size: 1.8em;
            font-weight: 300;
        }

        .header p {
            margin: 8px 0 0 0;
            opacity: 0.9;
            font-size: 1em;
        }

        .content {
            padding: 25px;
            margin-top: 80px;
        }

        .question {
            margin-bottom: 20px;
            padding: 18px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 4px solid #3498db;
            transition: all 0.3s ease;
        }

        .question:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .question-number {
            font-weight: bold;
            color: #2c3e50;
            font-size: 1.1em;
            margin-right: 8px;
        }

        .question-text {
            font-size: 1em;
            margin-bottom: 15px;
            color: #2c3e50;
            line-height: 1.5;
        }

        .options {
            display: grid;
            gap: 8px;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 12px;
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95em;
        }

        .option:hover {
            border-color: #3498db;
            background: #f0f8ff;
        }

        .option input[type="radio"] {
            margin-right: 15px;
            transform: scale(1.2);
            accent-color: #3498db;
        }

        .option.selected {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .submit-section {
            text-align: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e9ecef;
        }

        .submit-btn {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.4);
        }

        .submit-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .results {
            margin-top: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            display: none;
        }

        .score {
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .correct {
            border-color: #27ae60 !important;
            background: #d5f4e6 !important;
        }

        .incorrect {
            border-color: #e74c3c !important;
            background: #fadbd8 !important;
        }

        .reading-text {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            font-size: 1em;
            text-align: justify;
        }

        .reading-text h3 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .test-nav-btn {
            background: #ecf0f1;
            border: 2px solid #bdc3c7;
            color: #2c3e50;
            padding: 12px 25px;
            margin: 0 10px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .test-nav-btn:hover {
            background: #d5dbdb;
            border-color: #95a5a6;
        }

        .test-nav-btn.active {
            background: linear-gradient(135deg, #3498db, #2980b9);
            border-color: #3498db;
            color: white;
        }

        .test-nav-btn.completed {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            border-color: #27ae60;
            color: white;
        }

        #backBtn:hover {
            background: rgba(255,255,255,0.3) !important;
            border-color: rgba(255,255,255,0.5) !important;
            transform: translateY(-50%) scale(1.05) !important;
        }

        #fixedSubmitBtn:hover {
            background: linear-gradient(135deg, #2ecc71, #27ae60) !important;
            transform: translateY(-2px) scale(1.05) !important;
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.4) !important;
        }

        .timer-warning {
            background: #f39c12 !important;
        }

        .timer-critical {
            background: #e74c3c !important;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .test-container {
            display: none;
        }

        .test-container.active {
            display: block;
        }

        .text-input {
            border: 2px solid #3498db;
            border-radius: 5px;
            padding: 4px 6px;
            font-size: 0.9em;
            width: 120px;
            text-align: center;
            background: white;
            color: #2c3e50;
            font-weight: bold;
        }

        .text-input:focus {
            outline: none;
            border-color: #2980b9;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);
        }

        .dropdown-select {
            border: 2px solid #3498db;
            border-radius: 5px;
            padding: 4px 6px;
            font-size: 0.9em;
            background: white;
            color: #2c3e50;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 3px;
            min-width: 80px;
        }

        .dropdown-select:focus {
            outline: none;
            border-color: #2980b9;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);
        }

        .dropdown-select:hover {
            border-color: #2980b9;
        }

        .dropdown-select.correct {
            border-color: #27ae60 !important;
            background: #d5f4e6 !important;
        }

        .dropdown-select.incorrect {
            border-color: #e74c3c !important;
            background: #fadbd8 !important;
        }

        .text-passage {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            line-height: 1.8;
            font-size: 1.05em;
            text-align: justify;
        }

        .blank {
            display: inline-block;
            margin: 0 3px;
            vertical-align: baseline;
        }

        @media (max-width: 768px) {
            .container {
                margin: 5px auto 20px auto;
                border-radius: 12px;
            }
            
            .header {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 1.5em;
            }
            
            .content {
                padding: 15px;
                margin-top: 100px;
            }
            
            .question {
                padding: 15px;
                margin-bottom: 15px;
            }
            
            .option {
                padding: 10px;
                font-size: 0.9em;
            }

            .reading-text {
                padding: 15px;
                font-size: 0.95em;
            }

            #timerContainer {
                top: 10px !important;
                right: 10px !important;
                padding: 8px 12px !important;
                min-width: 120px !important;
            }

            #timerContainer #timerDisplay {
                font-size: 1.3em !important;
                margin-bottom: 3px !important;
            }

            #timerContainer div:nth-child(2) {
                font-size: 0.7em !important;
            }

            #backBtn {
                bottom: 10px !important;
                left: 10px !important;
                padding: 10px 15px !important;
                font-size: 0.85em !important;
            }

            #fixedSubmitBtn {
                bottom: 10px !important;
                right: 10px !important;
                padding: 10px 15px !important;
                font-size: 0.85em !important;
            }

            .text-input {
                width: 100px;
                font-size: 0.85em;
                padding: 3px 5px;
            }

            .dropdown-select {
                min-width: 70px;
                font-size: 0.85em;
                padding: 3px 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📝 Analisi delle Strutture di Comunicazione</h1>
            <p>Test n. 1 - Italiano</p>
        </div>

        <div class="content">
            <!-- Timer Display -->
            <div id="timerContainer" style="position: fixed; top: 20px; right: 20px; background: #3498db; color: white; padding: 15px 20px; border-radius: 15px; z-index: 1000; box-shadow: 0 5px 20px rgba(0,0,0,0.3); min-width: 200px;">
                <div style="font-size: 1.8em; font-weight: bold; margin-bottom: 5px; text-align: center;" id="timerDisplay">60:00</div>
                <div style="font-size: 0.85em; text-align: center; opacity: 0.9;">Tempo rimanente</div>
                <!-- Progress Bar -->
                <div id="progressContainer" style="margin-top: 12px; background: rgba(255,255,255,0.2); height: 4px; border-radius: 2px; overflow: hidden;">
                    <div id="progressBar" style="height: 100%; background: white; width: 0%; transition: width 1s ease; border-radius: 2px;"></div>
                </div>
            </div>

            <!-- Back Button -->
            <button id="backBtn" onclick="window.location.href='lettura.html'" style="position: fixed; bottom: 20px; left: 20px; background: rgba(44, 62, 80, 0.9); color: white; border: 2px solid rgba(255,255,255,0.3); padding: 12px 20px; border-radius: 25px; cursor: pointer; font-size: 0.9em; font-weight: 500; transition: all 0.3s ease; z-index: 1000; box-shadow: 0 5px 15px rgba(0,0,0,0.2);">
                ← Indietro
            </button>

            <!-- Test Navigation -->
            <div style="text-align: center; margin-bottom: 20px;">
                <button class="test-nav-btn active" id="test1Btn">
                    <span>Prova 1</span>
                </button>
                <button class="test-nav-btn" id="test2Btn">
                    <span>Prova 2</span>
                </button>
                <button class="test-nav-btn" id="test3Btn">
                    <span>Prova 3</span>
                </button>
                <button class="test-nav-btn" id="test4Btn">
                    <span>Prova 4</span>
                </button>
                <button class="test-nav-btn" id="resultsBtn" style="display: none; background: linear-gradient(135deg, #8e44ad, #9b59b6); border-color: #8e44ad; color: white;">
                    <span>📊 Risultati</span>
                </button>
            </div>

            <!-- Instructions -->
            <div id="testInstructions" style="background: #e8f4fd; border: 2px solid #3498db; border-radius: 10px; padding: 15px; margin-bottom: 25px; text-align: center; font-weight: 500; color: #2c3e50;">
                <span id="instructionText">Completa il testo con gli aggettivi e i pronomi appropriati. Puoi navigare liberamente tra le prove.</span>
            </div>

            <div id="test1" class="test-container active">
                <h2 style="text-align: center; color: #2c3e50; margin-bottom: 20px; font-size: 1.4em;">Prova n. 1</h2>
                <p style="text-align: center; color: #7f8c8d; margin-bottom: 20px; font-style: italic;">Completa il testo con gli aggettivi e i pronomi.</p>
                
                <div class="text-passage">
                    <h3 style="text-align: center; margin-bottom: 20px;">CHIARA FERRAGNI E LE <u>SUE</u> PASSIONI</h3>
                    
                    <p>Chiara Ferragni è nata a Cremona nel 1987. Nel 2009 ha avuto l'idea di lanciare TheBlondeSalad.com, il <span class="blank">(1) <input type="text" class="text-input" name="q1" placeholder="______"></span> diario personale online, in un periodo in <span class="blank">(2) <input type="text" class="text-input" name="q2" placeholder="______"></span> i blog non erano ancora così popolari e la parola selfie era ancora poco conosciuta. TheBlondeSalad nel tempo è diventato un vero e proprio sito web di ispirazione per gli <span class="blank">(3) <input type="text" class="text-input" name="q3" placeholder="______"></span>, dove si trovano tutte <span class="blank">(4) <input type="text" class="text-input" name="q4" placeholder="______"></span> cose che piacciono a Chiara e che <span class="blank">(5) <input type="text" class="text-input" name="q5" placeholder="______"></span> spera possano piacere ai <span class="blank">(6) <input type="text" class="text-input" name="q6" placeholder="______"></span> lettori: moda, bellezza, viaggi e ristoranti. Questo <span class="blank">(7) <input type="text" class="text-input" name="q7" placeholder="______"></span> ha permesso di diventare icona di stile per <span class="blank">(8) <input type="text" class="text-input" name="q8" placeholder="______"></span> ragazze, cosa che <span class="blank">(9) <input type="text" class="text-input" name="q9" placeholder="______"></span> rende molto orgogliosa.</p>
                    
                    <p>Inoltre si ritiene molto fortunata, perché ha la possibilità di fare <span class="blank">(10) <input type="text" class="text-input" name="q10" placeholder="______"></span> che ama di più: viaggiare e occuparsi di moda. Grazie a TheBlondSalad ha creato due aziende e ventisei persone vi lavorano a tempo pieno, <span class="blank">(11) <input type="text" class="text-input" name="q11" placeholder="______"></span> è lasciato al caso: posti, vestiti e persone che decide di farci vedere rispondono a criteri precisi.</p>
                    
                    <p><strong>Che tipo di ragazzina eri?</strong><br>
                    «Diversa. A differenza delle <span class="blank">(12) <input type="text" class="text-input" name="q12" placeholder="______"></span> due sorelle che avevano molti amici, io non <span class="blank">(13) <input type="text" class="text-input" name="q13" placeholder="______"></span> trovavo in sintonia con i coetanei. Volevo diventare qualcuno».</p>
                    
                    <p><strong>E tutta la <span class="blank">(14) <input type="text" class="text-input" name="q14" placeholder="______"></span> ambizione da dove arrivava?</strong><br>
                    «Da una grande fiducia in <span class="blank">(15) <input type="text" class="text-input" name="q15" placeholder="______"></span>, che ha saputo trasmettermi fin da piccola <span class="blank">(16) <input type="text" class="text-input" name="q16" placeholder="______"></span> madre».</p>
                    
                    <p><strong>Adesso sei fidanzata con Fedez, il famoso rapper. Come è nata la <span class="blank">(17) <input type="text" class="text-input" name="q17" placeholder="______"></span> storia?</strong><br>
                    «Dei <span class="blank">(18) <input type="text" class="text-input" name="q18" placeholder="______"></span> amici mi avevano detto che ero citata in una sua canzone; di ritorno da Los Angeles è stata la <span class="blank">(19) <input type="text" class="text-input" name="q19" placeholder="______"></span> canzone che ho ascoltato in Italia. Poi, per caso, ci siamo incontrati a pranzo da amici. <span class="blank">(20) <input type="text" class="text-input" name="q20" placeholder="______"></span> ha invitato a cena e non ci siamo più lasciati».</p>
                </div>
            </div>

            <div id="test2" class="test-container">
                <h2 style="text-align: center; color: #2c3e50; margin-bottom: 20px; font-size: 1.4em;">Prova n. 2</h2>
                <p style="text-align: center; color: #7f8c8d; margin-bottom: 20px; font-style: italic;">Completa il testo con le forme giuste dei verbi che sono tra parentesi.</p>
                
                <div class="text-passage">
                    <h3 style="text-align: center; margin-bottom: 20px;">RITA SALA: "SONO IO LA REGINA DELLO ZAFFERANO"</h3>
                    
                    <p>Era poco più di una bambina quando il nonno regalò a Rita Sala quella radice misteriosa e <span class="blank">(1) <input type="text" class="text-input" name="q1" placeholder="______"></span>: "È un tesoro, vedrai che ti <span class="blank">(2) <input type="text" class="text-input" name="q2" placeholder="______"></span> fortuna".</p>
                    
                    <p>Rita <span class="blank">(3) <input type="text" class="text-input" name="q3" placeholder="______"></span> in una famiglia di agricoltori novaresi ma <span class="blank">(4) <input type="text" class="text-input" name="q4" placeholder="______"></span> per tantissimi anni come imprenditrice nel settore tessile e come impiegata; alle soglie della pensione <span class="blank">(5) <input type="text" class="text-input" name="q5" placeholder="______"></span> il desiderio di rimettersi in gioco.</p>
                    
                    <p>"All'improvviso, <span class="blank">(6) <input type="text" class="text-input" name="q6" placeholder="______"></span> di quello che mi aveva detto il nonno e di quel tesoro. Non avevo ancora le idee chiare su cosa <span class="blank">(7) <input type="text" class="text-input" name="q7" placeholder="______"></span> con quella radice ma mi sono detta: <span class="blank">(8) <input type="text" class="text-input" name="q8" placeholder="______"></span>!".</p>
                    
                    <p>Rita ora <span class="blank">(9) <input type="text" class="text-input" name="q9" placeholder="______"></span> in città, a Novara, ma il legame con la campagna ce l'ha sempre avuto ed <span class="blank">(10) <input type="text" class="text-input" name="q10" placeholder="______"></span> quando ha deciso di cambiare vita e ripartire dalle parole del nonno. E così è stato: oggi <span class="blank">(11) <input type="text" class="text-input" name="q11" placeholder="______"></span> oltre 70mila piante di zafferano in due appezzamenti di terreno.</p>
                    
                    <p>Sapeva bene che per arrivare a realizzare un guadagno soddisfacente le ci <span class="blank">(12) <input type="text" class="text-input" name="q12" placeholder="______"></span> anni, ma Rita non <span class="blank">(13) <input type="text" class="text-input" name="q13" placeholder="______"></span>. "Non conoscevo nulla di zafferano o costi e allora <span class="blank">(14) <input type="text" class="text-input" name="q14" placeholder="______"></span> alle organizzazioni agricole della zona, nella speranza che qualcuno mi <span class="blank">(15) <input type="text" class="text-input" name="q15" placeholder="______"></span> consigli. Quando <span class="blank">(16) <input type="text" class="text-input" name="q16" placeholder="______"></span>, ben vestita, in pratica mi hanno fatto capire che non ero adatta. Allora io <span class="blank">(17) <input type="text" class="text-input" name="q17" placeholder="______"></span> di fare l'esatto opposto e <span class="blank">(18) <input type="text" class="text-input" name="q18" placeholder="______"></span> anima e corpo prima sui libri e poi a testa bassa sul terreno. E così, piano piano, come in una favola, c'è stata la moltiplicazione fino a che <span class="blank">(19) <input type="text" class="text-input" name="q19" placeholder="______"></span> a quel 70mila. Certo, la mia produzione è ancora una goccia nel mare, ma aumentarla <span class="blank">(20) <input type="text" class="text-input" name="q20" placeholder="______"></span> la mia sfida."</p>
                </div>
            </div>

            <div id="test3" class="test-container">
                <h2 style="text-align: center; color: #2c3e50; margin-bottom: 20px; font-size: 1.4em;">Prova n. 3</h2>
                <p style="text-align: center; color: #7f8c8d; margin-bottom: 20px; font-style: italic;">Completa il testo. Scegli una delle proposte di completamento.</p>
                
                <div class="text-passage">
                    <h3 style="text-align: center; margin-bottom: 20px;">IL FUTURO VA VERSO IED</h3>
                    
                    <p>Il mondo <u>contemporaneo</u> vive in un 
                    <select name="q1" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">impianto</option>
                        <option value="B">sistema</option>
                        <option value="C">gruppo</option>
                        <option value="D">organismo</option>
                    </select>
                    di relazioni di straordinaria complessità che 
                    <select name="q2" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">reclama</option>
                        <option value="B">vuole</option>
                        <option value="C">richiede</option>
                        <option value="D">domanda</option>
                    </select>
                    elevate competenze di comunicazione per poterlo gestire e comprendere. Per questo chi intende diventare un professionista nel campo della comunicazione e della creatività deve essere culturalmente e tecnicamente 
                    <select name="q3" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">elaborato</option>
                        <option value="B">posizionato</option>
                        <option value="C">organizzato</option>
                        <option value="D">preparato</option>
                    </select>
                    per comprendere appieno i cambiamenti di un mondo in 
                    <select name="q4" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">regolare</option>
                        <option value="B">continua</option>
                        <option value="C">abituale</option>
                        <option value="D">frequente</option>
                    </select>
                    evoluzione.</p>
                    
                    <p>Sono questi gli 
                    <select name="q5" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">attrezzi</option>
                        <option value="B">elementi</option>
                        <option value="C">strumenti</option>
                        <option value="D">apparecchi</option>
                    </select>
                    che si possono acquisire allo IED - Istituto Europeo di Design - che in Italia ha diverse 
                    <select name="q6" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">sedi</option>
                        <option value="B">residenze</option>
                        <option value="C">località</option>
                        <option value="D">posizioni</option>
                    </select>, come ad esempio Milano, Cagliari e Firenze.</p>
                    
                    <p>IED oggi è un eccellenza internazionale che opera nel 
                    <select name="q7" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">terreno</option>
                        <option value="B">campo</option>
                        <option value="C">reparto</option>
                        <option value="D">distretto</option>
                    </select>
                    della formazione e della ricerca nelle discipline del Design, della Moda, delle Arti visive e della Comunicazione.</p>
                    
                    <p>La preparazione che viene impartita allo IED risponde alle molteplici 
                    <select name="q8" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">esigenze</option>
                        <option value="B">mancanze</option>
                        <option value="C">pretese</option>
                        <option value="D">imposizioni</option>
                    </select>
                    di un mercato molto vario che 
                    <select name="q9" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">vaga</option>
                        <option value="B">gira</option>
                        <option value="C">spazia</option>
                        <option value="D">scorre</option>
                    </select>
                    dalla televisione all'arte, dai beni culturali alle organizzazioni internazionali. Una 
                    <select name="q10" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">disciplina</option>
                        <option value="B">dottrina</option>
                        <option value="C">scienza</option>
                        <option value="D">didattica</option>
                    </select>
                    di qualità insomma frutto anche della collaborazione tra il mondo 
                    <select name="q11" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">teorico</option>
                        <option value="B">accademico</option>
                        <option value="C">dotto</option>
                        <option value="D">solenne</option>
                    </select>
                    e professionale e delle relazioni con prestigiosi atenei internazionali. Tutte le attività si svolgono in aule tecnologicamente 
                    <select name="q12" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">avanzate</option>
                        <option value="B">spostate</option>
                        <option value="C">superate</option>
                        <option value="D">spinte</option>
                    </select>, dotate della strumentazione necessaria alla formazione e alla ricerca (computer con sistemi operativi Mac OS X e Windows, proiettori, impianto audio). Ogni istituto IED 
                    <select name="q13" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">regala</option>
                        <option value="B">consegna</option>
                        <option value="C">offre</option>
                        <option value="D">decide</option>
                    </select>
                    inoltre borse di studio per gli studenti più 
                    <select name="q14" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">dignitosi</option>
                        <option value="B">adeguati</option>
                        <option value="C">stimati</option>
                        <option value="D">meritevoli</option>
                    </select>
                    e possibilità di 
                    <select name="q15" class="dropdown-select">
                        <option value=""></option>
                        <option value="A">applicare</option>
                        <option value="B">effettuare</option>
                        <option value="C">creare</option>
                        <option value="D">impiegare</option>
                    </select>
                    attività di tirocinio e studio all'estero.</p>
                </div>
            </div>

            <div id="test4" class="test-container">
                <h2 style="text-align: center; color: #2c3e50; margin-bottom: 20px; font-size: 1.4em;">Prova n. 4</h2>
                <p style="text-align: center; color: #7f8c8d; margin-bottom: 20px; font-style: italic;">Scegli per ogni espressione una delle quattro situazioni di comunicazione.</p>
                
                <form id="testForm4">
                    <div class="question">
                        <div class="question-text"><span class="question-number">1.</span> <strong>ATTENZIONE</strong> - Gli studenti possono richiedere la modifica del piano di studio dal 1 al 30 aprile per esami da sostenere a partire dalla sessione di giugno-luglio.</div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q1" value="A">
                                <span>A) Il tutor universitario risponde alla tua domanda su come variare il piano di studio.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q1" value="B">
                                <span>B) Scrivi una nota sulla tua agenda per ricordarti il periodo in cui modificare il piano di studio.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q1" value="C">
                                <span>C) Nella Guida dello Studente leggi la regola sulla possibilità di variare il piano di studio.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q1" value="D">
                                <span>D) Durante una conversazione un tuo collega di università ti dà un consiglio sul piano di studio.</span>
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-text"><span class="question-number">2.</span> Presso la Libreria Becarelli, giovedì 16 marzo 2017, alle ore 17.00, il Centro Mara Meoni presenterà <em>Il passo breve delle cose</em> di Donatella Tognaccini. Introduce Teresa Lucente del Centro Mara Meoni, sarà presente l'autrice.</div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q2" value="A">
                                <span>A) Una tua amica ti invita alla presentazione di un libro.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q2" value="B">
                                <span>B) Sul giornale cittadino leggi la notizia della presentazione di un libro.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q2" value="C">
                                <span>C) In libreria la commessa ti comunica che hanno organizzato la presentazione di un libro.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q2" value="D">
                                <span>D) Sulla copertina del libro leggi in quale occasione il libro è stato presentato.</span>
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-text"><span class="question-number">3.</span> Oggi, per avere un approccio diverso alla nostra disciplina, l'economia, ho il piacere di presentarvi il nostro ospite, Niccolò Branca, presidente e amministratore delegato delle famose distillerie Branca.</div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q3" value="A">
                                <span>A) A lezione di economia il docente introduce un ospite che parlerà della sua esperienza professionale.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q3" value="B">
                                <span>B) Alla radio ascolti un'intervista all'amministratore delegato di un'azienda italiana di successo.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q3" value="C">
                                <span>C) In una riunione di lavoro il tuo superiore ti presenta un ospite importante.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q3" value="D">
                                <span>D) Durante un convegno sull'economia il moderatore dà la parola all'amministratore delegato della Branca.</span>
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-text"><span class="question-number">4.</span> Buongiorno da Massimo Cerofolini. Benvenuti a Eta Beta. 3356992949 per Sms e WhatsApp. Etabetaradiouno per Facebook e per Twitter.</div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q4" value="A">
                                <span>A) Leggi un avviso sul sito internet della trasmissione radiofonica Eta Beta.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q4" value="B">
                                <span>B) È il messaggio della segreteria telefonica del giornalista Massimo Cerofolini.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q4" value="C">
                                <span>C) È la pubblicità di una trasmissione radiofonica che prevede interventi del pubblico.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q4" value="D">
                                <span>D) Il giornalista di una trasmissione radiofonica dà i contatti per gli interventi degli ascoltatori.</span>
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-text"><span class="question-number">5.</span> Il Programma ERASMUS Plus è una forma di mobilità che offre agli studenti l'opportunità di effettuare un tirocinio formativo all'estero presso imprese, centri di formazione e di ricerca.</div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q5" value="A">
                                <span>A) Leggi le informazioni relative al nuovo Programma ERASMUS Plus sul sito della tua università.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q5" value="B">
                                <span>B) Parli con un tuo amico che è rientrato da un soggiorno all'estero con il Programma ERASMUS Plus.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q5" value="C">
                                <span>C) Ascolti alla radio la pubblicità realizzata dal Ministero dell'Università per promuovere il Programma ERASMUS Plus.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q5" value="D">
                                <span>D) Sei interessato al Programma ERASMUS Plus e ti informi presso la Segreteria studenti della tua Università.</span>
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-text"><span class="question-number">6.</span> Al parcheggio aeroporto Catania ParkinGO potrai scegliere tra una vasta gamma di servizi complementari alla sosta: lavaggio auto, avvolgimento bagagli, riparazioni alla carrozzeria, tagliandi e revisioni su richiesta.</div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q6" value="A">
                                <span>A) È un messaggio promozionale di un parcheggio aeroportuale che offre prestazioni aggiuntive.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q6" value="B">
                                <span>B) È un messaggio di un amico che ti consiglia di lasciare la macchina al parcheggio ParkinGO di Catania.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q6" value="C">
                                <span>C) È il cartello pubblicitario di un parcheggio aeroportuale che vedi lungo la strada.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q6" value="D">
                                <span>D) È l'offerta di servizi che la commessa del ParkinGO di Catania ti fa quando lasci la tua auto.</span>
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-text"><span class="question-number">7.</span> Guardi, è molto semplice fare l'autolettura dei consumi del gas: deve scrivere i primi sei numeri del contatore del gas, telefonare al numero verde e seguire le istruzioni.</div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q7" value="A">
                                <span>A) A casa dai spiegazioni a tua sorella su come fare l'autolettura del consumo del gas.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q7" value="B">
                                <span>B) Sulla fattura del gas leggi le istruzioni per comunicare la lettura del contatore.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q7" value="C">
                                <span>C) Un operatore dell'azienda del gas ti spiega come fare l'autolettura del consumo del gas.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q7" value="D">
                                <span>D) Al telefono ascolti le istruzioni del risponditore automatico per comunicare la lettura del contatore.</span>
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-text"><span class="question-number">8.</span> Camera singola in affitto in appartamento vicino al Politecnico. L'appartamento è composto da 2 camere doppie e una singola, cucina abitabile, una grande sala comune e 2 bagni con doccia. Il prezzo della singola è di € 360,00. Chiamare 333 402739.</div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q8" value="A">
                                <span>A) Scrivi un messaggio ad un amico per avvertirlo che si è liberata una camera singola nell'appartamento in cui vivi.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q8" value="B">
                                <span>B) Leggi un annuncio di una camera in affitto nella bacheca del Politecnico.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q8" value="C">
                                <span>C) Ascolti la descrizione di una camera in affitto che ti fa un agente immobiliare.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q8" value="D">
                                <span>D) Sul sito dell'università leggi le caratteristiche delle camere della residenza universitaria.</span>
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-text"><span class="question-number">9.</span> Ragazza di madrelingua francese cerca madrelingua italiano per uno scambio di conversazione francese-italiano. Contattare laurine@gmail.com.</div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q9" value="A">
                                <span>A) È un messaggio lasciato alla segreteria telefonica di una scuola di lingua italiana.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q9" value="B">
                                <span>B) È la pubblicità di un nuovo sito di traduzione on line italiano-francese.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q9" value="C">
                                <span>C) È uno scambio di informazioni tra studentesse di un corso di laurea in lingue.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q9" value="D">
                                <span>D) È un annuncio per trovare una persona con cui parlare la lingua italiana.</span>
                            </label>
                        </div>
                    </div>

                    <div class="question">
                        <div class="question-text"><span class="question-number">10.</span> Vieni in negozio a scoprire i nuovi occhiali da sole a un prezzo mai visto! Occhiali a 40 euro con lenti antigraffio.</div>
                        <div class="options">
                            <label class="option">
                                <input type="radio" name="q10" value="A">
                                <span>A) In un negozio di ottica il proprietario parla con un cliente.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q10" value="B">
                                <span>B) È la promozione di un tipo di occhiali.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q10" value="C">
                                <span>C) Due amici parlano dell'apertura di un nuovo negozio di ottica.</span>
                            </label>
                            <label class="option">
                                <input type="radio" name="q10" value="D">
                                <span>D) È la pubblicità di una nuova marca di occhiali.</span>
                            </label>
                        </div>
                    </div>
                </form>
            </div>

            <div id="results" class="results">
                <div class="score" id="scoreDisplay"></div>
                <div id="detailedResults" style="margin-top: 20px;"></div>
                <p style="text-align: center; color: #7f8c8d;">Le risposte corrette sono evidenziate in verde, quelle sbagliate in rosso.</p>
            </div>

            <div class="submit-section" style="display: none;">
                <button class="submit-btn" id="submitBtn" onclick="endExam()">
                    🏁 Termina Esame
                </button>
            </div>

            <!-- Fixed Submit Button -->
            <button id="fixedSubmitBtn" onclick="endExam()" style="position: fixed; bottom: 20px; right: 20px; background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; border: 2px solid rgba(255,255,255,0.3); padding: 12px 20px; border-radius: 25px; cursor: pointer; font-size: 0.9em; font-weight: 500; transition: all 0.3s ease; z-index: 1000; box-shadow: 0 5px 15px rgba(46, 204, 113, 0.3);">
                🏁 Termina Esame
            </button>
        </div>
    </div>

    <script>
        // Exam configuration
        const EXAM_DURATION = 60 * 60; // 60 minutes
        
        // Correct answers for all four tests
        const correctAnswers = {
            test1: {
                q1: 'suo', q2: 'cui', q3: 'altri', q4: 'quelle', q5: 'lei', q6: 'suoi', q7: 'le', q8: 'molte', q9: 'la', q10: 'quello', q11: ['niente','nulla'], q12: 'mie', q13: 'mi', q14: 'sua', q15: 'me', q16: 'mia', q17: 'vostra', q18: 'miei', q19: 'prima', q20: 'mi'
            },
            test2: {
                q1: 'aggiunse', q2: 'porterà', q3: 'è nata', q4: 'ha lavotato', q5: 'è arrivato', q6: 'mi sono ricordata', q7: ['fare','avrei'], q8: ['proviamo','prova'] q9: 'abita', q10: 'è riemerso', q11: 'coltiva', q12: 'sarebbero voluti', q13: 'si è arresa', q14: 'mi sono rivolta', q15: 'desse', q16: 'mi sono presentata', q17: 'ho pensato', q18: 'mi sono gettata', q19: 'sono arrivata', q20: 'rappresenta'
            },
            test3: {
                q1: 'B', q2: 'C', q3: 'D', q4: 'B', q5: 'C', q6: 'A', q7: 'B', q8: 'A', q9: 'C', q10: 'D', q11: 'B', q12: 'A', q13: 'C', q14: 'D', q15: 'B'
            },
            test4: {
                q1: 'C', q2: 'B', q3: 'A', q4: 'D', q5: 'A', q6: 'A', q7: 'C', q8: 'B', q9: 'D', q10: 'B'
            }

        };

        // Exam state
        let examStarted = true;
        let timeRemaining = EXAM_DURATION;
        let currentTest = 1;
        let timerInterval;

        // Initialize exam
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-start exam immediately
            startExam();
            
            // Add click handlers to options
            document.addEventListener('click', function(e) {
                if (e.target.closest('.option')) {
                    const option = e.target.closest('.option');
                    const radio = option.querySelector('input[type="radio"]');
                    radio.checked = true;
                    
                    // Remove selected class from siblings
                    const siblings = option.parentNode.querySelectorAll('.option');
                    siblings.forEach(sibling => sibling.classList.remove('selected'));
                    
                    // Add selected class to this option
                    option.classList.add('selected');
                }
            });

            // Test navigation buttons
            document.getElementById('test1Btn').addEventListener('click', () => showTest(1));
            document.getElementById('test2Btn').addEventListener('click', () => showTest(2));
            document.getElementById('test3Btn').addEventListener('click', () => showTest(3));
            document.getElementById('test4Btn').addEventListener('click', () => showTest(4));
            document.getElementById('resultsBtn').addEventListener('click', showResults);
        });

        function startExam() {
            examStarted = true;
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('submitBtn').style.display = 'inline-block';
            document.getElementById('fixedSubmitBtn').style.display = 'inline-block';
            
            // Enable all test navigation buttons
            document.querySelectorAll('.test-nav-btn').forEach(btn => {
                if (btn.id !== 'resultsBtn') {
                    btn.disabled = false;
                }
            });
            
            // Start timer
            timerInterval = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            timeRemaining--;
            
            // Update display
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            const display = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timerDisplay').textContent = display;
            
            // Update progress bar
            const progress = ((EXAM_DURATION - timeRemaining) / EXAM_DURATION) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            
            // Update timer color based on time remaining
            const timerContainer = document.getElementById('timerContainer');
            if (timeRemaining <= 300) { // 5 minutes
                timerContainer.style.background = '#e74c3c';
                timerContainer.style.animation = 'pulse 1s infinite';
            } else if (timeRemaining <= 600) { // 10 minutes
                timerContainer.style.background = '#f39c12';
                timerContainer.style.animation = 'none';
            }
            
            // End exam when time is up
            if (timeRemaining <= 0) {
                endExam();
            }
        }

        function showTest(testNumber) {
            currentTest = testNumber;
            
            // Hide all tests
            document.querySelectorAll('.test-container').forEach(container => {
                container.classList.remove('active');
            });
            
            // Show selected test
            document.getElementById(`test${testNumber}`).classList.add('active');
            
            // Show instructions when navigating to a test
            document.getElementById('testInstructions').style.display = 'block';
            
            // Update navigation buttons
            document.querySelectorAll('.test-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(`test${testNumber}Btn`).classList.add('active');
            
            // Update instructions based on current test
            const instructionText = document.getElementById('instructionText');
            if (testNumber === 1) {
                instructionText.textContent = 'Completa il testo con gli aggettivi e i pronomi appropriati.';
            } else if (testNumber === 2) {
                instructionText.textContent = 'Completa il testo con le forme giuste dei verbi che sono tra parentesi.';
            } else if (testNumber === 3) {
                instructionText.textContent = 'Completa il testo. Scegli una delle proposte di completamento.';
            } else if (testNumber === 4) {
                instructionText.textContent = 'Scegli per ogni espressione una delle quattro situazioni di comunicazione.';
            }
        }

        function endExam() {
            clearInterval(timerInterval);
            examStarted = false;
            
            // Stop timer animation
            const timerContainer = document.getElementById('timerContainer');
            timerContainer.style.animation = 'none';
            
            // Hide submit buttons
            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('fixedSubmitBtn').style.display = 'none';
            
            // Mark all tests as completed
            document.querySelectorAll('.test-nav-btn').forEach(btn => {
                if (btn.id !== 'resultsBtn') {
                    btn.classList.add('completed');
                    btn.classList.remove('active');
                }
            });
            
            // Show and enable results button
            const resultsBtn = document.getElementById('resultsBtn');
            resultsBtn.style.display = 'inline-block';
            resultsBtn.disabled = false;
            resultsBtn.classList.add('active');
            
            // Calculate total score
            calculateFinalResults();
            
            // Show results
            showResults();
            
            // Disable all interactions
            document.querySelectorAll('input[type="radio"]').forEach(input => {
                input.disabled = true;
            });
            document.querySelectorAll('.text-input').forEach(input => {
                input.disabled = true;
            });
            document.querySelectorAll('.dropdown-select').forEach(select => {
                select.disabled = true;
            });
        }

        function calculateFinalResults() {
            let totalScore = 0;
            let totalQuestions = 0;
            let detailedResults = '';
            
            // Check Test 1 (text completion)
            const answers1 = correctAnswers.test1;
            let test1Score = 0;
            
            // Define alternative answers for some questions
            const alternatives = {
                q8: ['molte', 'tante', 'parecchie'],
                q10: ['quello', 'ciò'],
                q11: ['niente', 'nulla']
            };
            
            for (let i = 1; i <= 20; i++) {
                const input = document.querySelector(`input[name="q${i}"]`);
                const userAnswer = input ? input.value.trim().toLowerCase() : '';
                const correctAnswer = answers1[`q${i}`].toLowerCase();
                
                let isCorrect = false;
                
                // Check if there are alternative answers for this question
                if (alternatives[`q${i}`]) {
                    isCorrect = alternatives[`q${i}`].some(alt => alt.toLowerCase() === userAnswer);
                } else {
                    isCorrect = userAnswer === correctAnswer;
                }
                
                if (isCorrect) {
                    test1Score++;
                    input.style.borderColor = '#27ae60';
                    input.style.background = '#d5f4e6';
                } else {
                    input.style.borderColor = '#e74c3c';
                    input.style.background = '#fadbd8';
                    // Show correct answer (or first alternative)
                    if (alternatives[`q${i}`]) {
                        input.value = alternatives[`q${i}`][0];
                    } else {
                        input.value = answers1[`q${i}`];
                    }
                }
            }
            
            totalScore += test1Score;
            totalQuestions += 20;
            
            // Check Test 2 (text completion like Test 1)
            const answers2 = correctAnswers.test2;
            let test2Score = 0;
            
            // Define alternative answers for Test 2
            const alternatives2 = {
                q6: ['mi ricordai', 'mi sono ricordata'],
                q8: ['proviamo', 'provo'],
                q12: ['sarebbero voluti', 'ci sarebbero voluti', 'ci volevano'],
                q13: ['si arrese', 'si è arresa']
            };
            
            for (let i = 1; i <= 20; i++) {
                const input = document.querySelector(`#test2 input[name="q${i}"]`);
                const userAnswer = input ? input.value.trim().toLowerCase() : '';
                const correctAnswer = answers2[`q${i}`].toLowerCase();
                
                let isCorrect = false;
                
                // Check if there are alternative answers for this question
                if (alternatives2[`q${i}`]) {
                    isCorrect = alternatives2[`q${i}`].some(alt => alt.toLowerCase() === userAnswer);
                } else {
                    isCorrect = userAnswer === correctAnswer;
                }
                
                if (isCorrect) {
                    test2Score++;
                    input.style.borderColor = '#27ae60';
                    input.style.background = '#d5f4e6';
                } else {
                    input.style.borderColor = '#e74c3c';
                    input.style.background = '#fadbd8';
                    // Show correct answer (or first alternative)
                    if (alternatives2[`q${i}`]) {
                        input.value = alternatives2[`q${i}`][0];
                    } else {
                        input.value = answers2[`q${i}`];
                    }
                }
            }
            
            totalScore += test2Score;
            totalQuestions += 20;
            
            // Check Test 3 (dropdown)
            const answers3 = correctAnswers.test3;
            let test3Score = 0;
            
            for (let i = 1; i <= 15; i++) {
                const dropdown = document.querySelector(`#test3 select[name="q${i}"]`);
                const userAnswer = dropdown ? dropdown.value : '';
                const correctAnswer = answers3[`q${i}`];
                
                if (userAnswer === correctAnswer) {
                    test3Score++;
                    dropdown.classList.add('correct');
                } else {
                    dropdown.classList.add('incorrect');
                    // Show correct answer
                    dropdown.value = correctAnswer;
                }
            }
            
            totalScore += test3Score;
            totalQuestions += 15;
            
            // Check Test 4 (multiple choice)
            const form4 = document.getElementById('testForm4');
            const formData4 = new FormData(form4);
            const answers4 = correctAnswers.test4;
            let test4Score = 0;
            const questionsInTest4 = Object.keys(answers4).length;
            
            for (let i = 1; i <= questionsInTest4; i++) {
                const questionName = `q${i}`;
                const userAnswer = formData4.get(questionName);
                const correctAnswer = answers4[questionName];
                
                const testContainer = document.getElementById('test4');
                const questionOptions = testContainer.querySelectorAll(`input[name="${questionName}"]`);
                
                questionOptions.forEach(option => {
                    const optionContainer = option.closest('.option');
                    
                    if (option.value === correctAnswer) {
                        optionContainer.classList.add('correct');
                    } else if (option.checked && option.value !== correctAnswer) {
                        optionContainer.classList.add('incorrect');
                    }
                });
                
                if (userAnswer === correctAnswer) {
                    test4Score++;
                }
            }
            
            totalScore += test4Score;
            totalQuestions += questionsInTest4;
            
            // Add detailed results
            detailedResults += `
                <div style="margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                    <strong>Prova 3:</strong> ${test3Score}/15
                </div>
                <div style="margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                    <strong>Prova 4:</strong> ${test4Score}/${questionsInTest4}
                </div>
            `;
            
            // Add Test 1 and Test 2 results at the beginning
            detailedResults = `
                <div style="margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                    <strong>Prova 1:</strong> ${test1Score}/20
                </div>
                <div style="margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                    <strong>Prova 2:</strong> ${test2Score}/20
                </div>
            ` + detailedResults;
            
            // Display final results
            const finalPercentage = Math.round((totalScore / totalQuestions) * 100);
            const noteOn20 = Math.round((totalScore / totalQuestions) * 20 * 100) / 100;
            let resultClass = '';
            let resultMessage = '';
            
            if (finalPercentage >= 80) {
                resultClass = 'color: #27ae60;';
                resultMessage = '🎉 Eccellente!';
            } else if (finalPercentage >= 70) {
                resultClass = 'color: #f39c12;';
                resultMessage = '👍 Buono!';
            } else if (finalPercentage >= 60) {
                resultClass = 'color: #e67e22;';
                resultMessage = '📚 Sufficiente';
            } else {
                resultClass = 'color: #e74c3c;';
                resultMessage = '📖 Da migliorare';
            }
            
            document.getElementById('scoreDisplay').innerHTML = `
                <div style="${resultClass} font-size: 1.8em; margin-bottom: 15px;">${resultMessage}</div>
                <div style="font-size: 1.4em; margin-bottom: 10px;">Punteggio Totale: ${totalScore}/${totalQuestions}</div>
                <div style="font-size: 1.2em; color: #7f8c8d;">Voto: ${noteOn20}/20</div>
            `;
            
            document.getElementById('detailedResults').innerHTML = detailedResults;
        }

        function showResults() {
            // Hide all test containers
            document.querySelectorAll('.test-container').forEach(container => {
                container.classList.remove('active');
            });
            
            // Hide instructions when showing results
            document.getElementById('testInstructions').style.display = 'none';
            
            // Show results
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
            
            // Update button states
            document.querySelectorAll('.test-nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById('resultsBtn').classList.add('active');
        }

        // Manual test navigation during exam
        document.addEventListener('click', function(e) {
            if (e.target.closest('.test-nav-btn') && !e.target.closest('.test-nav-btn').disabled) {
                const btn = e.target.closest('.test-nav-btn');
                
                // Handle results button
                if (btn.id === 'resultsBtn') {
                    showResults();
                    return;
                }
                
                const testNumber = parseInt(btn.id.replace('test', '').replace('Btn', ''));
                showTest(testNumber);
                
                // Hide results when navigating to a test after exam completion
                if (timeRemaining <= 0) {
                    document.getElementById('results').style.display = 'none';
                }
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9873cb6e30dad6ae',t:'MTc1OTIzNjA4OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

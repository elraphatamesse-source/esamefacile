<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Produzione Scritta - CILS B2</title>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            margin: 15px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .section-title {
            font-size: 1.4em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .exercise-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .exercise-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 2px solid transparent;
        }

        .exercise-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.2);
            border-color: #667eea;
        }

        .exercise-card h3 {
            color: #2c3e50;
            margin: 0 0 15px 0;
            font-size: 1.2em;
        }

        .exercise-card p {
            color: #7f8c8d;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .difficulty-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .difficulty-beginner { background: #d4edda; color: #155724; }
        .difficulty-intermediate { background: #fff3cd; color: #856404; }
        .difficulty-advanced { background: #f8d7da; color: #721c24; }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .close {
            position: absolute;
            right: 15px;
            top: 15px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #aaa;
            transition: color 0.3s ease;
        }

        .close:hover {
            color: #e74c3c;
        }

        .writing-area {
            width: 100%;
            height: 250px;
            padding: 15px;
            border: 2px solid #667eea;
            border-radius: 10px;
            font-size: 1em;
            line-height: 1.6;
            resize: vertical;
            font-family: inherit;
        }

        .writing-area:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }

        .word-count {
            text-align: right;
            margin-top: 10px;
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .tips-box {
            background: #e8f4fd;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }

        .tips-box h4 {
            margin-top: 0;
            color: #2c3e50;
        }

        .tips-box ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .tips-box li {
            margin-bottom: 8px;
            line-height: 1.5;
        }

        .premium-banner {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            text-align: center;
            position: relative;
            overflow: hidden;
            animation: premiumGlow 3s ease-in-out infinite alternate;
        }

        @keyframes premiumGlow {
            0% { box-shadow: 0 0 20px rgba(240, 147, 251, 0.3); }
            100% { box-shadow: 0 0 40px rgba(245, 87, 108, 0.5); }
        }

        .premium-banner::before {
            content: '✨';
            position: absolute;
            top: -10px;
            right: -10px;
            font-size: 3em;
            opacity: 0.3;
            animation: sparkle 2s ease-in-out infinite;
        }

        @keyframes sparkle {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.2); }
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .feature-card {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: left;
            backdrop-filter: blur(10px);
        }

        .feature-card h4 {
            margin: 0 0 8px 0;
            font-size: 1.1em;
        }

        .feature-card p {
            margin: 0;
            font-size: 0.9em;
            opacity: 0.9;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .progress-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .skill-progress {
            margin: 15px 0;
        }

        .skill-name {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .progress-bar-container {
            background: #e9ecef;
            border-radius: 10px;
            height: 12px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 1s ease;
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .achievement-badge {
            display: inline-block;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #8b6914;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            margin: 5px;
            box-shadow: 0 3px 10px rgba(255, 215, 0, 0.3);
        }

        .timer-display {
            background: #2c3e50;
            color: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            font-size: 1.5em;
            font-weight: bold;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }

        .writing-tools {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .tool-btn {
            background: #f8f9fa;
            border: 2px solid #667eea;
            color: #667eea;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .tool-btn:hover {
            background: #667eea;
            color: white;
        }

        .vocabulary-popup {
            position: absolute;
            background: #2c3e50;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.9em;
            z-index: 1001;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: none;
        }

        .grammar-highlight {
            background: rgba(102, 126, 234, 0.2);
            padding: 2px 4px;
            border-radius: 3px;
            cursor: help;
        }

        .feedback-detailed {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .feedback-section {
            margin: 15px 0;
            padding: 15px;
            border-left: 4px solid #667eea;
            background: #f8f9fa;
            border-radius: 0 8px 8px 0;
        }

        .score-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: conic-gradient(#667eea 0deg, #764ba2 180deg, #e9ecef 180deg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.2em;
            margin: 0 auto 15px;
        }

        .premium-banner h3 {
            margin: 0 0 15px 0;
            font-size: 1.5em;
        }

        .premium-banner p {
            margin: 0 0 20px 0;
            opacity: 0.95;
            line-height: 1.6;
        }

        .premium-btn {
            background: white;
            color: #f5576c;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .premium-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255,255,255,0.3);
        }

        .info-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .info-section h3 {
            color: #2c3e50;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .container { max-width: 95%; }
            .exercise-grid { grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
            .stats-container { grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); }
        }

        @media (max-width: 992px) {
            .header h1 { font-size: 2.2em; }
            .section-title { font-size: 1.2em; }
            .exercise-card { padding: 20px; }
            .feature-grid { grid-template-columns: 1fr; }
            .modal-content { max-width: 90%; }
        }

        @media (max-width: 768px) {
            body { padding: 10px; }
            .container { border-radius: 15px; }
            .header { padding: 20px 15px; }
            .header h1 { font-size: 1.8em; }
            .header p { font-size: 1em; }
            .content { padding: 20px 15px; }
            .section { padding: 15px; margin-bottom: 20px; }
            .section-title { font-size: 1.1em; flex-direction: column; text-align: center; gap: 5px; }
            .exercise-grid { grid-template-columns: 1fr; gap: 15px; }
            .exercise-card { padding: 15px; }
            .exercise-card h3 { font-size: 1.1em; }
            .stats-container { grid-template-columns: repeat(2, 1fr); gap: 10px; }
            .stat-card { padding: 15px; }
            .stat-number { font-size: 1.5em; }
            .modal-content { 
                padding: 15px; 
                margin: 10px; 
                max-height: 90vh; 
                width: 95%;
            }
            .writing-area { height: 200px; }
            .writing-tools { justify-content: center; }
            .tool-btn { font-size: 0.8em; padding: 6px 12px; }
            .btn { padding: 10px 20px; font-size: 0.9em; margin: 3px; }
            .premium-banner { padding: 20px 15px; }
            .premium-banner h3 { font-size: 1.3em; }
            .feature-card { padding: 12px; }
        }

        @media (max-width: 576px) {
            .header h1 { font-size: 1.6em; }
            .header p { font-size: 0.9em; }
            .content { padding: 15px 10px; }
            .section { padding: 12px; margin-bottom: 15px; }
            .section-title { font-size: 1em; }
            .exercise-card { padding: 12px; }
            .exercise-card h3 { font-size: 1em; }
            .exercise-card p { font-size: 0.9em; }
            .stats-container { grid-template-columns: 1fr; gap: 8px; }
            .stat-card { padding: 12px; }
            .stat-number { font-size: 1.3em; }
            .stat-label { font-size: 0.8em; }
            .skill-progress { margin: 10px 0; }
            .skill-name { font-size: 0.9em; }
            .progress-bar-container { height: 10px; }
            .achievement-badge { font-size: 0.7em; padding: 6px 12px; margin: 3px; }
            .modal-content { 
                padding: 12px; 
                margin: 5px; 
                border-radius: 15px;
            }
            .writing-area { height: 180px; font-size: 0.9em; }
            .word-count { font-size: 0.8em; }
            .timer-display { font-size: 1.2em; padding: 12px; }
            .btn { padding: 8px 16px; font-size: 0.8em; }
            .tool-btn { font-size: 0.7em; padding: 5px 10px; }
            .tips-box { padding: 15px; }
            .tips-box h4 { font-size: 1em; }
            .tips-box li { font-size: 0.9em; }
            .premium-banner { padding: 15px 10px; }
            .premium-banner h3 { font-size: 1.2em; }
            .premium-banner p { font-size: 0.9em; }
            .feature-card { padding: 10px; }
            .feature-card h4 { font-size: 1em; }
            .feature-card p { font-size: 0.8em; }
        }

        @media (max-width: 400px) {
            .header h1 { font-size: 1.4em; }
            .content { padding: 10px 8px; }
            .section { padding: 10px; }
            .exercise-card { padding: 10px; }
            .modal-content { padding: 10px; margin: 3px; }
            .writing-area { height: 150px; }
            .btn { padding: 6px 12px; font-size: 0.75em; }
            .stats-container { gap: 5px; }
            .stat-card { padding: 10px; }
        }

        /* Landscape orientation for tablets */
        @media (max-width: 1024px) and (orientation: landscape) {
            .exercise-grid { grid-template-columns: repeat(2, 1fr); }
            .stats-container { grid-template-columns: repeat(4, 1fr); }
        }

        /* Small tablets portrait */
        @media (min-width: 577px) and (max-width: 768px) {
            .exercise-grid { grid-template-columns: repeat(2, 1fr); }
            .stats-container { grid-template-columns: repeat(2, 1fr); }
        }

        /* Touch-friendly improvements */
        @media (hover: none) and (pointer: coarse) {
            .exercise-card { 
                padding: 20px;
                min-height: 120px;
            }
            .btn { 
                min-height: 44px;
                min-width: 44px;
                padding: 12px 20px;
            }
            .tool-btn {
                min-height: 40px;
                padding: 10px 15px;
            }
            .close {
                font-size: 32px;
                padding: 10px;
                min-width: 44px;
                min-height: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
        }

        /* Simulation modal responsive */
        @media (max-width: 768px) {
            .modal-content[style*="max-width: 900px"] {
                max-width: 95% !important;
            }
            
            .simulation-grid {
                display: block !important;
                grid-template-columns: none !important;
            }
            
            .simulation-grid > div {
                margin-bottom: 20px;
            }
            
            #examText1, #examText2 {
                height: 120px !important;
            }
        }

        /* Improve readability on small screens */
        @media (max-width: 576px) {
            .tips-box ul {
                padding-left: 15px;
            }
            
            .feedback-section ul {
                padding-left: 15px;
            }
            
            .info-section p {
                font-size: 0.9em;
                line-height: 1.5;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎓 Produzione scritta</h1>
            <p>Preparazione CILS B2 - Esercizi di scrittura italiana</p>
        </div>

        <div class="content">
            <!-- Dashboard Statistiche Personali -->
            <div class="progress-section">
                <h3 style="color: #2c3e50; margin-top: 0; display: flex; align-items: center; gap: 10px;">
                    📊 Il tuo progresso
                </h3>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-number">47</div>
                        <div class="stat-label">Esercizi completati</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">8.2</div>
                        <div class="stat-label">Punteggio medio</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">23h</div>
                        <div class="stat-label">Tempo di studio</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">12</div>
                        <div class="stat-label">Giorni consecutivi</div>
                    </div>
                </div>

                <div style="margin: 25px 0;">
                    <h4 style="color: #2c3e50; margin-bottom: 15px;">🎯 Competenze linguistiche</h4>
                    
                    <div class="skill-progress">
                        <div class="skill-name">
                            <span>Grammatica e sintassi</span>
                            <span>85%</span>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar-fill" style="width: 85%;"></div>
                        </div>
                    </div>
                    
                    <div class="skill-progress">
                        <div class="skill-name">
                            <span>Lessico e vocabolario</span>
                            <span>72%</span>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar-fill" style="width: 72%;"></div>
                        </div>
                    </div>
                    
                    <div class="skill-progress">
                        <div class="skill-name">
                            <span>Coerenza e coesione</span>
                            <span>78%</span>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar-fill" style="width: 78%;"></div>
                        </div>
                    </div>
                    
                    <div class="skill-progress">
                        <div class="skill-name">
                            <span>Registro e stile</span>
                            <span>91%</span>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar-fill" style="width: 91%;"></div>
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 20px;">
                    <span class="achievement-badge">🏆 Scrittore esperto</span>
                    <span class="achievement-badge">📚 Studente costante</span>
                    <span class="achievement-badge">⚡ Velocità di scrittura</span>
                </div>
            </div>

            <!-- Informazioni Generali -->
            <div class="info-section">
                <h3>📋 Informazioni sull'esame CILS B2</h3>
                <p style="line-height: 1.6; color: #7f8c8d;">
                    La prova di <strong>Produzione scritta</strong> del CILS B2 consiste in due prove: un testo breve 
                    (email, lettera, messaggio) e un testo più lungo (tema, articolo, racconto). Dovrai dimostrare di saper 
                    utilizzare registri diversi e una varietà lessicale adeguata al livello B2.
                </p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0;">
                    <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                        <div style="font-size: 1.5em; color: #667eea; font-weight: bold;">70 min</div>
                        <div style="font-size: 0.9em; color: #7f8c8d;">Durata totale</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                        <div style="font-size: 1.5em; color: #667eea; font-weight: bold;">2 Prove</div>
                        <div style="font-size: 0.9em; color: #7f8c8d;">Breve + Lungo</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                        <div style="font-size: 1.5em; color: #667eea; font-weight: bold;">80-140</div>
                        <div style="font-size: 0.9em; color: #7f8c8d;">Parole totali</div>
                    </div>
                </div>
            </div>

            <!-- Testi brevi -->
            <div class="section">
                <div class="section-title">
                    ✍️ Testi brevi (80-100 parole)
                </div>
                
                <div class="exercise-grid">
                    <div class="exercise-card" onclick="openExercise('email-formale')">
                        <h3>📧 Email formale</h3>
                        <p>Scrivi un'email al tuo professore per spiegare un'assenza e chiedere il materiale per recuperare.</p>
                        <span class="difficulty-badge difficulty-beginner">Principiante</span>
                    </div>
                    
                    <div class="exercise-card" onclick="openExercise('messaggio-informale')">
                        <h3>💌 Messaggio informale</h3>
                        <p>Manda un messaggio a un amico per invitarlo alla tua festa di compleanno con tutti i dettagli.</p>
                        <span class="difficulty-badge difficulty-beginner">Principiante</span>
                    </div>
                    
                    <div class="exercise-card" onclick="openExercise('lettera-reclamo')">
                        <h3>📝 Lettera di reclamo</h3>
                        <p>Scrivi al servizio clienti per lamentarti di un prodotto difettoso e chiedere la sostituzione.</p>
                        <span class="difficulty-badge difficulty-intermediate">Intermedio</span>
                    </div>
                </div>
            </div>

            <!-- Testi lunghi -->
            <div class="section">
                <div class="section-title">
                    📖 Testi lunghi (120-140 parole)
                </div>
                
                <div class="exercise-grid">
                    <div class="exercise-card" onclick="openExercise('tema-argomentativo')">
                        <h3>💭 Tema argomentativo</h3>
                        <p>Discuti vantaggi e svantaggi dell'uso dei social network tra i giovani con esempi concreti.</p>
                        <span class="difficulty-badge difficulty-advanced">Avanzato</span>
                    </div>
                    
                    <div class="exercise-card" onclick="openExercise('articolo-giornale')">
                        <h3>📰 Articolo di giornale</h3>
                        <p>Scrivi per un giornale studentesco sul ruolo dello sport nella vita quotidiana dei giovani.</p>
                        <span class="difficulty-badge difficulty-intermediate">Intermedio</span>
                    </div>
                    
                    <div class="exercise-card" onclick="openExercise('racconto-narrativo')">
                        <h3>🌟 Racconto narrativo</h3>
                        <p>Racconta un'esperienza indimenticabile di viaggio descrivendo emozioni e importanza.</p>
                        <span class="difficulty-badge difficulty-intermediate">Intermedio</span>
                    </div>
                </div>
            </div>

            <!-- Strumenti di supporto -->
            <div class="section">
                <div class="section-title">
                    🛠️ Strumenti di supporto
                </div>
                
                <div class="exercise-grid">
                    <div class="exercise-card" onclick="openTool('connettivi')">
                        <h3>🔗 Connettivi testuali</h3>
                        <p>Guida completa ai connettivi per strutturare i tuoi testi in modo coerente.</p>
                        <span class="difficulty-badge difficulty-beginner">Guida</span>
                    </div>
                    
                    <div class="exercise-card" onclick="openTool('lessico')">
                        <h3>📚 Lessico B2</h3>
                        <p>Vocabolario essenziale per il livello B2 organizzato per temi e contesti.</p>
                        <span class="difficulty-badge difficulty-intermediate">Riferimento</span>
                    </div>
                    
                    <div class="exercise-card" onclick="openTool('grammatica')">
                        <h3>📖 Grammatica avanzata</h3>
                        <p>Ripasso delle strutture grammaticali complesse richieste al livello B2.</p>
                        <span class="difficulty-badge difficulty-advanced">Teoria</span>
                    </div>
                    
                    <div class="exercise-card" onclick="openTool('modelli')">
                        <h3>📄 Testi modello</h3>
                        <p>Esempi di testi ben strutturati per ogni tipologia d'esame con analisi dettagliata.</p>
                        <span class="difficulty-badge difficulty-intermediate">Esempi</span>
                    </div>
                </div>
            </div>



            <!-- Consigli per superare l'esame -->
            <div class="section">
                <div class="section-title">
                    🎯 Consigli per superare l'esame
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
                    <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                        <h4 style="color: #2c3e50; margin-top: 0; display: flex; align-items: center; gap: 10px;">
                            ⏰ Gestione del tempo
                        </h4>
                        <ul style="color: #7f8c8d; line-height: 1.6; margin: 0; padding-left: 20px;">
                            <li><strong>Pianifica 70 minuti:</strong> 30 min per il testo breve, 40 min per quello lungo</li>
                            <li><strong>Primi 5 minuti:</strong> Leggi attentamente le tracce e pianifica</li>
                            <li><strong>Ultimi 10 minuti:</strong> Rileggi e correggi errori evidenti</li>
                            <li><strong>Non bloccarti:</strong> Se non sai una parola, usa un sinonimo</li>
                            <li><strong>Conta le parole:</strong> Controlla regolarmente di rispettare i limiti</li>
                        </ul>
                    </div>
                    
                    <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                        <h4 style="color: #2c3e50; margin-top: 0; display: flex; align-items: center; gap: 10px;">
                            📝 Struttura del testo
                        </h4>
                        <ul style="color: #7f8c8d; line-height: 1.6; margin: 0; padding-left: 20px;">
                            <li><strong>Introduzione chiara:</strong> Presenta subito l'argomento principale</li>
                            <li><strong>Sviluppo logico:</strong> Organizza le idee in paragrafi coerenti</li>
                            <li><strong>Conclusione efficace:</strong> Riassumi o esprimi la tua opinione finale</li>
                            <li><strong>Usa connettivi:</strong> tuttavia, inoltre, infatti, quindi, per esempio</li>
                            <li><strong>Varia le frasi:</strong> Alterna frasi brevi e lunghe per ritmo</li>
                        </ul>
                    </div>
                    
                    <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                        <h4 style="color: #2c3e50; margin-top: 0; display: flex; align-items: center; gap: 10px;">
                            🎭 Registro linguistico
                        </h4>
                        <ul style="color: #7f8c8d; line-height: 1.6; margin: 0; padding-left: 20px;">
                            <li><strong>Email formali:</strong> "Egregio/Gentile", "La ringrazio", "Cordiali saluti"</li>
                            <li><strong>Messaggi informali:</strong> "Ciao", "Come va?", "A presto", "Baci"</li>
                            <li><strong>Articoli:</strong> Tono neutro, informativo, esempi concreti</li>
                            <li><strong>Temi argomentativi:</strong> "A mio parere", "Ritengo che", "È evidente"</li>
                            <li><strong>Racconti:</strong> Tempi del passato, descrizioni vivaci</li>
                        </ul>
                    </div>
                    
                    <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                        <h4 style="color: #2c3e50; margin-top: 0; display: flex; align-items: center; gap: 10px;">
                            ✅ Controllo finale
                        </h4>
                        <ul style="color: #7f8c8d; line-height: 1.6; margin: 0; padding-left: 20px;">
                            <li><strong>Accordi:</strong> Verifica soggetto-verbo, articolo-nome</li>
                            <li><strong>Tempi verbali:</strong> Mantieni coerenza temporale</li>
                            <li><strong>Punteggiatura:</strong> Virgole, punti, apostrofi corretti</li>
                            <li><strong>Ortografia:</strong> Rileggi parole difficili e nomi propri</li>
                            <li><strong>Completezza:</strong> Hai risposto a tutti i punti della traccia?</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Strategie Specifiche per Tipologia -->
                <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border-radius: 15px; padding: 25px; margin-top: 25px;">
                    <h4 style="margin-top: 0; text-align: center; font-size: 1.3em;">🎯 Strategie per ogni tipologia</h4>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 20px; backdrop-filter: blur(10px);">
                            <h5 style="margin: 0 0 15px 0; font-size: 1.1em;">📧 Email e lettere formali</h5>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.9em; line-height: 1.5;">
                                <li>Oggetto chiaro e specifico</li>
                                <li>Saluto appropriato al destinatario</li>
                                <li>Esponi il problema/richiesta subito</li>
                                <li>Fornisci dettagli necessari</li>
                                <li>Chiedi azione specifica</li>
                                <li>Chiusura cortese e professionale</li>
                            </ul>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 20px; backdrop-filter: blur(10px);">
                            <h5 style="margin: 0 0 15px 0; font-size: 1.1em;">💌 Messaggi informali</h5>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.9em; line-height: 1.5;">
                                <li>Tono amichevole e diretto</li>
                                <li>Usa contrazioni (non c'è, com'è)</li>
                                <li>Emoticon appropriate (con moderazione)</li>
                                <li>Riferimenti personali condivisi</li>
                                <li>Inviti all'azione ("Fammi sapere!")</li>
                                <li>Saluti calorosi</li>
                            </ul>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 20px; backdrop-filter: blur(10px);">
                            <h5 style="margin: 0 0 15px 0; font-size: 1.1em;">📰 Articoli e temi</h5>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.9em; line-height: 1.5;">
                                <li>Titolo accattivante (se richiesto)</li>
                                <li>Tesi chiara nell'introduzione</li>
                                <li>Argomenti pro e contro bilanciati</li>
                                <li>Esempi concreti e attuali</li>
                                <li>Dati statistici (anche inventati)</li>
                                <li>Conclusione con opinione personale</li>
                            </ul>
                        </div>
                        
                        <div style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 20px; backdrop-filter: blur(10px);">
                            <h5 style="margin: 0 0 15px 0; font-size: 1.1em;">🌟 Racconti narrativi</h5>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.9em; line-height: 1.5;">
                                <li>Ambientazione chiara (dove, quando)</li>
                                <li>Personaggi ben definiti</li>
                                <li>Sequenza cronologica logica</li>
                                <li>Descrizioni sensoriali vivaci</li>
                                <li>Dialoghi per rendere dinamico</li>
                                <li>Messaggio o riflessione finale</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Errori Comuni da Evitare -->
                <div style="background: #fff3cd; border-radius: 15px; padding: 25px; margin-top: 25px; border-left: 5px solid #ffc107;">
                    <h4 style="color: #856404; margin-top: 0; display: flex; align-items: center; gap: 10px;">
                        ⚠️ Errori comuni da evitare
                    </h4>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 15px;">
                        <div>
                            <h5 style="color: #856404; margin: 0 0 10px 0;">❌ Errori di contenuto</h5>
                            <ul style="color: #856404; margin: 0; padding-left: 20px; font-size: 0.9em;">
                                <li>Non rispondere a tutti i punti della traccia</li>
                                <li>Andare fuori tema o divagare troppo</li>
                                <li>Ripetere le stesse idee senza svilupparle</li>
                                <li>Non fornire esempi concreti</li>
                                <li>Conclusioni troppo brevi o assenti</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h5 style="color: #856404; margin: 0 0 10px 0;">❌ Errori di forma</h5>
                            <ul style="color: #856404; margin: 0; padding-left: 20px; font-size: 0.9em;">
                                <li>Testi troppo corti o troppo lunghi</li>
                                <li>Registro inappropriato (formale/informale)</li>
                                <li>Mancanza di connettivi tra le frasi</li>
                                <li>Paragrafi troppo lunghi o assenti</li>
                                <li>Punteggiatura scorretta o mancante</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h5 style="color: #856404; margin: 0 0 10px 0;">❌ Errori linguistici</h5>
                            <ul style="color: #856404; margin: 0; padding-left: 20px; font-size: 0.9em;">
                                <li>Accordi soggetto-verbo sbagliati</li>
                                <li>Uso scorretto dei tempi verbali</li>
                                <li>Preposizioni sbagliate</li>
                                <li>Ripetizione eccessiva delle stesse parole</li>
                                <li>Calchi dalla lingua madre</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- Checklist Pre-Esame -->
                <div style="background: white; border-radius: 15px; padding: 25px; margin-top: 25px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                    <h4 style="color: #2c3e50; margin-top: 0; text-align: center;">📋 Checklist pre-esame</h4>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
                            <h5 style="color: #2c3e50; margin: 0 0 10px 0;">📚 Preparazione teorica</h5>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.9em; color: #7f8c8d;">
                                <li>✅ Conosco i connettivi principali</li>
                                <li>✅ So usare congiuntivo e condizionale</li>
                                <li>✅ Padroneggio i registri formale/informale</li>
                                <li>✅ Conosco le strutture dei testi</li>
                            </ul>
                        </div>
                        
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
                            <h5 style="color: #2c3e50; margin: 0 0 10px 0;">✍️ Pratica scritta</h5>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.9em; color: #7f8c8d;">
                                <li>✅ Ho fatto almeno 10 simulazioni complete</li>
                                <li>✅ So gestire il tempo (70 minuti)</li>
                                <li>✅ Rispetto sempre i limiti di parole</li>
                                <li>✅ Ho praticato tutte le tipologie</li>
                            </ul>
                        </div>
                        
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
                            <h5 style="color: #2c3e50; margin: 0 0 10px 0;">🎯 Strategia d'esame</h5>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.9em; color: #7f8c8d;">
                                <li>✅ Leggo sempre tutta la traccia prima</li>
                                <li>✅ Pianifico la struttura mentalmente</li>
                                <li>✅ Tengo sempre 10 min per rilettura</li>
                                <li>✅ Controllo accordi e punteggiatura</li>
                            </ul>
                        </div>
                        
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
                            <h5 style="color: #2c3e50; margin: 0 0 10px 0;">🧘 Preparazione mentale</h5>
                            <ul style="margin: 0; padding-left: 20px; font-size: 0.9em; color: #7f8c8d;">
                                <li>✅ Sono rilassato e concentrato</li>
                                <li>✅ Ho dormito bene la notte prima</li>
                                <li>✅ Ho fiducia nelle mie capacità</li>
                                <li>✅ So gestire l'ansia da esame</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Simulazione d'esame -->
            <div class="section">
                <div class="section-title">
                    🎭 Simulazione d'esame
                </div>
                
                <div style="background: white; border-radius: 15px; padding: 25px; text-align: center;">
                    <h3 style="color: #2c3e50; margin-top: 0;">Prova completa CILS B2</h3>
                    <p style="color: #7f8c8d; line-height: 1.6; margin-bottom: 25px;">
                        Mettiti alla prova con una simulazione completa dell'esame. 70 minuti, 2 prove (breve + lungo), 
                        condizioni realistiche per prepararti al meglio.
                    </p>
                    <button class="btn" onclick="startSimulation()">🚀 Inizia simulazione</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal per esercizi -->
    <div id="exerciseModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeModal('exerciseModal')">&times;</span>
            <div id="exerciseContent"></div>
        </div>
    </div>

    <!-- Modal per strumenti -->
    <div id="toolModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeModal('toolModal')">&times;</span>
            <div id="toolContent"></div>
        </div>
    </div>

    <!-- Modal per simulazione -->
    <div id="simulationModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeModal('simulationModal')">&times;</span>
            <div id="simulationContent"></div>
        </div>
    </div>

    <script>
        // Esercizi di scrittura
        const exercises = {
            // Testi brevi (80-100 parole)
            'email-formale': {
                title: '📧 Email formale',
                prompt: 'Scrivi un\'email al tuo professore per spiegare che non puoi partecipare a una lezione perché sei malato e chiedi il materiale per recuperare.',
                tips: [
                    'Usa un oggetto chiaro e specifico',
                    'Inizia con "Gentile Professore/Professoressa"',
                    'Spiega brevemente il motivo dell\'assenza',
                    'Chiedi cortesemente il materiale della lezione',
                    'Concludi con "Cordiali saluti" e il tuo nome'
                ],
                wordCount: '80-100 parole'
            },
            'messaggio-informale': {
                title: '💌 Messaggio informale',
                prompt: 'Manda un messaggio a un amico per invitarlo alla tua festa di compleanno. Indica dove si svolgerà, l\'orario e cosa deve portare.',
                tips: [
                    'Usa un tono amichevole e diretto',
                    'Inizia con un saluto informale (Ciao, Ehi)',
                    'Specifica data, ora e luogo della festa',
                    'Indica cosa l\'amico deve portare',
                    'Chiedi conferma di partecipazione'
                ],
                wordCount: '80-100 parole'
            },
            'lettera-reclamo': {
                title: '📝 Lettera di Reclamo',
                prompt: 'Scrivi al servizio clienti di un negozio online per lamentarti di un prodotto arrivato difettoso e chiedere la sostituzione.',
                tips: [
                    'Inizia con "Gentile Servizio Clienti"',
                    'Indica numero d\'ordine e data d\'acquisto',
                    'Descrivi brevemente il difetto del prodotto',
                    'Chiedi la sostituzione o il rimborso',
                    'Mantieni un tono fermo ma educato'
                ],
                wordCount: '80-100 parole'
            },
            
            // Testi lunghi (120-140 parole)
            'tema-argomentativo': {
                title: '💭 Tema Argomentativo',
                prompt: 'Molti giovani oggi trascorrono molto tempo sui social network. Secondo te, quali sono i vantaggi e gli svantaggi di questo comportamento? Esprimi la tua opinione con esempi concreti.',
                tips: [
                    'Presenta il tema nell\'introduzione',
                    'Elenca 2-3 vantaggi con esempi specifici',
                    'Presenta 2-3 svantaggi con esempi concreti',
                    'Usa connettivi per collegare le idee',
                    'Concludi con la tua opinione personale motivata'
                ],
                wordCount: '120-140 parole'
            },
            'articolo-giornale': {
                title: '📰 Articolo di Giornale',
                prompt: 'Un giornale studentesco ti chiede di scrivere un articolo sul ruolo dello sport nella vita quotidiana dei giovani. Presenta i benefici e le difficoltà.',
                tips: [
                    'Inizia con un titolo accattivante',
                    'Presenta l\'argomento in modo chiaro',
                    'Descrivi i benefici dello sport per i giovani',
                    'Menziona le difficoltà e gli ostacoli',
                    'Usa un linguaggio giornalistico ma accessibile'
                ],
                wordCount: '120-140 parole'
            },
            'racconto-narrativo': {
                title: '🌟 Racconto Narrativo',
                prompt: 'Racconta un\'esperienza indimenticabile che hai vissuto durante un viaggio: descrivi le emozioni provate e spiega perché è rimasta così importante per te.',
                tips: [
                    'Usa i tempi del passato appropriati',
                    'Descrivi il luogo e l\'atmosfera',
                    'Racconta l\'esperienza in ordine cronologico',
                    'Esprimi le emozioni provate in quel momento',
                    'Spiega perché l\'esperienza è stata significativa'
                ],
                wordCount: '120-140 parole'
            }
        };

        // Strumenti di supporto
        const tools = {
            'connettivi': {
                title: '🔗 Connettivi Testuali',
                content: `
                    <h3>Connettivi per Strutturare i Tuoi Testi</h3>
                    
                    <div class="tips-box">
                        <h4>🔄 Connettivi di Sequenza</h4>
                        <ul>
                            <li><strong>Prima di tutto, innanzitutto</strong> - per iniziare</li>
                            <li><strong>In secondo luogo, inoltre</strong> - per aggiungere</li>
                            <li><strong>Infine, per concludere</strong> - per chiudere</li>
                        </ul>
                    </div>
                    
                    <div class="tips-box">
                        <h4>⚖️ Connettivi di Contrasto</h4>
                        <ul>
                            <li><strong>Tuttavia, però, ma</strong> - opposizione semplice</li>
                            <li><strong>Al contrario, invece</strong> - contrasto forte</li>
                            <li><strong>Nonostante, malgrado</strong> - concessione</li>
                        </ul>
                    </div>
                    
                    <div class="tips-box">
                        <h4>📈 Connettivi di Causa-Effetto</h4>
                        <ul>
                            <li><strong>Perciò, quindi, dunque</strong> - conseguenza</li>
                            <li><strong>A causa di, per via di</strong> - causa negativa</li>
                            <li><strong>Grazie a, per merito di</strong> - causa positiva</li>
                        </ul>
                    </div>
                `
            },
            'lessico': {
                title: '📚 Lessico B2',
                content: `
                    <h3>Vocabolario Essenziale per il B2</h3>
                    
                    <div class="tips-box">
                        <h4>💼 Ambito Lavorativo</h4>
                        <ul>
                            <li><strong>Candidarsi, assumere, licenziare</strong></li>
                            <li><strong>Colloquio, curriculum, esperienza</strong></li>
                            <li><strong>Competenze, qualifiche, formazione</strong></li>
                        </ul>
                    </div>
                    
                    <div class="tips-box">
                        <h4>🏛️ Società e Cultura</h4>
                        <ul>
                            <li><strong>Tradizione, usanza, costume</strong></li>
                            <li><strong>Integrazione, diversità, tolleranza</strong></li>
                            <li><strong>Patrimonio, eredità, identità</strong></li>
                        </ul>
                    </div>
                    
                    <div class="tips-box">
                        <h4>🌍 Ambiente e Sostenibilità</h4>
                        <ul>
                            <li><strong>Inquinamento, riciclaggio, sostenibile</strong></li>
                            <li><strong>Rinnovabile, ecologico, biodegradabile</strong></li>
                            <li><strong>Cambiamenti climatici, effetto serra</strong></li>
                        </ul>
                    </div>
                `
            },
            'grammatica': {
                title: '📖 Grammatica avanzata',
                content: `
                    <h3>Strutture Grammaticali B2</h3>
                    
                    <div class="tips-box">
                        <h4>🎭 Congiuntivo</h4>
                        <ul>
                            <li><strong>Opinioni:</strong> Penso che sia giusto</li>
                            <li><strong>Dubbi:</strong> Non credo che venga</li>
                            <li><strong>Speranze:</strong> Spero che tutto vada bene</li>
                            <li><strong>Condizioni:</strong> Purché tu faccia attenzione</li>
                        </ul>
                    </div>
                    
                    <div class="tips-box">
                        <h4>🔄 Condizionale</h4>
                        <ul>
                            <li><strong>Cortesia:</strong> Vorrei un caffè</li>
                            <li><strong>Consigli:</strong> Dovresti studiare di più</li>
                            <li><strong>Ipotesi:</strong> Se avessi tempo, viaggerei</li>
                        </ul>
                    </div>
                    
                    <div class="tips-box">
                        <h4>👥 Forma Passiva</h4>
                        <ul>
                            <li><strong>Con essere:</strong> Il libro è stato scritto</li>
                            <li><strong>Con venire:</strong> La casa viene pulita</li>
                            <li><strong>Si passivante:</strong> Si vendono case</li>
                        </ul>
                    </div>
                `
            },
            'modelli': {
                title: '📄 Testi Modello',
                content: `
                    <h3>Esempi di testi ben strutturati</h3>
                    
                    <div style="margin-bottom: 20px;">
                        <button class="tool-btn" onclick="showModelCategory('email-formali')" style="margin: 5px;">📧 Email formali</button>
                        <button class="tool-btn" onclick="showModelCategory('messaggi-informali')" style="margin: 5px;">💌 Messaggi informali</button>
                        <button class="tool-btn" onclick="showModelCategory('temi-argomentativi')" style="margin: 5px;">💭 Temi argomentativi</button>
                        <button class="tool-btn" onclick="showModelCategory('articoli')" style="margin: 5px;">📰 Articoli</button>
                        <button class="tool-btn" onclick="showModelCategory('racconti')" style="margin: 5px;">🌟 Racconti</button>
                    </div>
                    
                    <div id="modelContent">
                        <div style="text-align: center; padding: 40px; color: #7f8c8d;">
                            <h4>Seleziona una categoria per vedere i modelli</h4>
                            <p>Ogni modello include analisi dettagliata delle strutture linguistiche utilizzate</p>
                        </div>
                    </div>
                `
            }
        };

        function openExercise(exerciseId) {
            const exercise = exercises[exerciseId];
            const modal = document.getElementById('exerciseModal');
            const content = document.getElementById('exerciseContent');
            
            content.innerHTML = `
                <h2>${exercise.title}</h2>
                
                <div class="tips-box">
                    <h4>📝 Traccia</h4>
                    <p>${exercise.prompt}</p>
                    <p><strong>Lunghezza richiesta:</strong> ${exercise.wordCount}</p>
                </div>
                
                <div class="tips-box">
                    <h4>💡 Suggerimenti</h4>
                    <ul>
                        ${exercise.tips.map(tip => `<li>${tip}</li>`).join('')}
                    </ul>
                </div>
                
                <h4>✍️ Scrivi il tuo testo:</h4>
                
                <div class="writing-tools">
                    <button class="tool-btn" onclick="insertConnective()">🔗 Connettivi</button>
                    <button class="tool-btn" onclick="suggestVocabulary()">📚 Sinonimi</button>
                    <button class="tool-btn" onclick="checkGrammar()">✅ Grammatica</button>
                    <button class="tool-btn" onclick="formatText()">📝 Formattazione</button>
                    <button class="tool-btn" onclick="startTimer()">⏱️ Timer</button>
                </div>
                
                <div class="timer-display" id="timerDisplay" style="display: none;">
                    ⏱️ Tempo rimanente: <span id="timeLeft">--:--</span>
                </div>
                
                <textarea class="writing-area" id="writingText" placeholder="Inizia a scrivere qui..."></textarea>
                
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                    <div class="word-count">
                        Parole: <span id="wordCounter">0</span> | Caratteri: <span id="charCounter">0</span>
                    </div>
                    <div style="font-size: 0.9em; color: #7f8c8d;">
                        Tempo di scrittura: <span id="writingTime">0:00</span>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" onclick="checkTextAdvanced()">🔍 Analisi completa</button>
                    <button class="btn" onclick="saveText()">💾 Salva Bozza</button>
                    <button class="btn btn-secondary" onclick="clearText()">🗑️ Cancella</button>
                </div>
                
                <div id="feedback" style="margin-top: 20px;"></div>
            `;
            
            modal.style.display = 'flex';
            
            // Enhanced word counter and writing tracker
            document.getElementById('writingText').addEventListener('input', function() {
                const text = this.value;
                const wordCount = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
                const charCount = text.length;
                
                document.getElementById('wordCounter').textContent = wordCount;
                document.getElementById('charCounter').textContent = charCount;
                
                // Start writing time tracking
                if (!writingStartTime && text.length > 0) {
                    writingStartTime = Date.now();
                    writingTimeInterval = setInterval(updateWritingTime, 1000);
                }
                
                // Color coding for word count
                const wordCountElement = document.getElementById('wordCounter');
                if (wordCount < 80) {
                    wordCountElement.style.color = '#e74c3c';
                } else if (wordCount > 140) {
                    wordCountElement.style.color = '#f39c12';
                } else {
                    wordCountElement.style.color = '#27ae60';
                }
            });
            
            function updateWritingTime() {
                if (writingStartTime) {
                    const elapsed = Math.floor((Date.now() - writingStartTime) / 1000);
                    const minutes = Math.floor(elapsed / 60);
                    const seconds = elapsed % 60;
                    document.getElementById('writingTime').textContent = 
                        `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }
            }
        }

        function openTool(toolId) {
            const tool = tools[toolId];
            const modal = document.getElementById('toolModal');
            const content = document.getElementById('toolContent');
            
            content.innerHTML = `
                <h2>${tool.title}</h2>
                ${tool.content}
            `;
            
            modal.style.display = 'flex';
        }

        // Database dei testi modello
        const modelTexts = {
            'email-formali': [
                {
                    title: "Email al Professore per Assenza",
                    wordCount: "95 parole",
                    text: `Gentile Professor Rossi,

Le scrivo per informarLa che non potrò partecipare alla lezione di italiano di domani, mercoledì 15 marzo, a causa di un improvviso problema di salute. Ho la febbre alta e il medico mi ha consigliato di rimanere a casa per evitare di contagiare i compagni.

Vorrei chiederLe cortesemente se è possibile ricevere il materiale della lezione e gli eventuali compiti assegnati. Sono molto interessato agli argomenti che stiamo trattando e non vorrei rimanere indietro.

La ringrazio per la comprensione e spero di tornare presto in classe.

Cordiali saluti,
Marco Bianchi`,
                    analysis: `
                        <h4>📊 Analisi del testo</h4>
                        <ul>
                            <li><strong>Struttura:</strong> Saluto formale → Spiegazione problema → Richiesta specifica → Ringraziamento → Chiusura</li>
                            <li><strong>Registro:</strong> Formale (Gentile, La ringrazio, Cordiali saluti)</li>
                            <li><strong>Tempi verbali:</strong> Presente, futuro, condizionale di cortesia</li>
                            <li><strong>Connettivi:</strong> "a causa di", "per evitare", "se è possibile"</li>
                            <li><strong>Cortesia:</strong> "cortesemente", "vorrei", "spero"</li>
                        </ul>
                    `
                },
                {
                    title: "Lettera di Reclamo al Servizio Clienti",
                    wordCount: "98 parole",
                    text: `Egregio Servizio Clienti,

Vi scrivo per segnalare un problema con l'ordine n. 12345 effettuato il 10 marzo scorso sul vostro sito web. Ho ricevuto ieri il pacco, ma il prodotto è arrivato danneggiato: la confezione era aperta e l'articolo presentava evidenti graffi sulla superficie.

Sono molto deluso da questa situazione, soprattutto considerando che si trattava di un regalo per mia madre. Chiedo pertanto la sostituzione immediata del prodotto o, in alternativa, il rimborso completo dell'importo pagato.

Allego le foto del danno e attendo una vostra pronta risposta.

Distinti saluti,
Andrea Verdi`,
                    analysis: `
                        <h4>📊 Analisi del testo</h4>
                        <ul>
                            <li><strong>Struttura:</strong> Saluto → Identificazione problema → Descrizione dettagliata → Richiesta soluzione → Chiusura</li>
                            <li><strong>Tono:</strong> Fermo ma educato, professionale</li>
                            <li><strong>Dettagli specifici:</strong> Numero ordine, data, descrizione precisa del danno</li>
                            <li><strong>Richiesta chiara:</strong> Sostituzione o rimborso</li>
                            <li><strong>Azioni concrete:</strong> "Allego le foto", "attendo risposta"</li>
                        </ul>
                    `
                }
            ],
            'messaggi-informali': [
                {
                    title: "Invito alla Festa di Compleanno",
                    wordCount: "89 parole",
                    text: `Ciao Sara!

Come va? Spero tutto bene! Ti scrivo per invitarti alla mia festa di compleanno che organizzo sabato 20 maggio alle ore 19:00 a casa mia. Sarà una serata tranquilla con gli amici più cari, buona musica e ovviamente la torta!

Se puoi, porta qualcosa da bere o degli snack salati. Non serve niente di particolare, anche una bottiglia d'acqua va benissimo! 

Fammi sapere se riesci a venire entro giovedì, così posso organizzarmi meglio per il cibo.

Non vedo l'ora di festeggiare insieme!

Baci,
Giulia`,
                    analysis: `
                        <h4>📊 Analisi del testo</h4>
                        <ul>
                            <li><strong>Tono:</strong> Amichevole, caloroso, diretto</li>
                            <li><strong>Saluto informale:</strong> "Ciao", "Come va?"</li>
                            <li><strong>Dettagli pratici:</strong> Data, ora, luogo, cosa portare</li>
                            <li><strong>Richiesta di conferma:</strong> "Fammi sapere entro giovedì"</li>
                            <li><strong>Chiusura affettuosa:</strong> "Non vedo l'ora", "Baci"</li>
                        </ul>
                    `
                },
                {
                    title: "Messaggio per Organizzare Studio di Gruppo",
                    wordCount: "92 parole",
                    text: `Ehi ragazzi!

Allora, per l'esame di storia di lunedì prossimo che ne dite di organizzare una sessione di studio insieme? Io propongo domenica pomeriggio dalle 14:00 alle 18:00 in biblioteca.

Potremmo dividerci i capitoli: io prendo il Rinascimento, tu Marco potresti fare l'Illuminismo e Lisa il Romanticismo. Così ci aiutiamo a vicenda e ripassiamo tutto meglio!

Portate i vostri appunti e qualche snack per la pausa. Ah, e non dimenticate i libri! 😄

Confermate entro stasera, così prenoto il tavolo grande in biblioteca.

A presto!
Alex`,
                    analysis: `
                        <h4>📊 Analisi del testo</h4>
                        <ul>
                            <li><strong>Linguaggio giovanile:</strong> "Ehi ragazzi", "che ne dite"</li>
                            <li><strong>Proposta organizzativa:</strong> Orario, luogo, divisione compiti</li>
                            <li><strong>Tono collaborativo:</strong> "ci aiutiamo a vicenda"</li>
                            <li><strong>Emoticon appropriata:</strong> 😄 per alleggerire</li>
                            <li><strong>Call to action:</strong> "Confermate entro stasera"</li>
                        </ul>
                    `
                }
            ],
            'temi-argomentativi': [
                {
                    title: "I Social Network tra i Giovani",
                    wordCount: "135 parole",
                    text: `I social network sono diventati una parte fondamentale della vita quotidiana dei giovani, ma il loro impatto è controverso.

Da un lato, questi strumenti offrono vantaggi significativi. Permettono di mantenere contatti con amici lontani, condividere esperienze e interessi comuni. Inoltre, rappresentano una fonte importante di informazioni e opportunità di apprendimento. Molti giovani sviluppano competenze digitali utili per il futuro lavorativo.

Tuttavia, esistono anche aspetti negativi preoccupanti. L'uso eccessivo può causare dipendenza e isolamento sociale reale. Spesso i ragazzi preferiscono le relazioni virtuali a quelle faccia a faccia. Inoltre, fenomeni come il cyberbullismo e la diffusione di fake news rappresentano rischi concreti.

A mio parere, i social network sono strumenti potenti che, se usati con consapevolezza e moderazione, possono arricchire la vita sociale dei giovani senza sostituire le relazioni autentiche.`,
                    analysis: `
                        <h4>📊 Analisi del Testo</h4>
                        <ul>
                            <li><strong>Struttura:</strong> Introduzione → Vantaggi → Svantaggi → Opinione personale</li>
                            <li><strong>Connettivi:</strong> "Da un lato", "Tuttavia", "Inoltre", "A mio parere"</li>
                            <li><strong>Esempi concreti:</strong> Cyberbullismo, fake news, competenze digitali</li>
                            <li><strong>Bilanciamento:</strong> Uguale spazio a pro e contro</li>
                            <li><strong>Conclusione personale:</strong> Posizione chiara e motivata</li>
                        </ul>
                    `
                },
                {
                    title: "L'Importanza dello Sport nella Vita Quotidiana",
                    wordCount: "128 parole",
                    text: `Lo sport riveste un ruolo cruciale nella vita moderna, offrendo benefici che vanno oltre il semplice benessere fisico.

Innanzitutto, l'attività sportiva migliora significativamente la salute: rafforza il sistema cardiovascolare, aumenta la resistenza e aiuta a mantenere un peso corporeo ideale. Questi vantaggi sono particolarmente importanti in un'epoca caratterizzata da stili di vita sedentari.

Dal punto di vista psicologico, lo sport rappresenta un efficace antistress. Durante l'attività fisica, il corpo rilascia endorfine che migliorano l'umore e riducono l'ansia. Inoltre, praticare sport in gruppo favorisce la socializzazione e insegna valori fondamentali come il rispetto, la collaborazione e la determinazione.

Nonostante i costi e il tempo richiesto possano rappresentare ostacoli, ritengo che investire nello sport significhi investire nella propria qualità di vita presente e futura.`,
                    analysis: `
                        <h4>📊 Analisi del Testo</h4>
                        <ul>
                            <li><strong>Approccio sistematico:</strong> Benefici fisici → psicologici → sociali</li>
                            <li><strong>Linguaggio scientifico:</strong> "endorfine", "sistema cardiovascolare"</li>
                            <li><strong>Connessione con l'attualità:</strong> "stili di vita sedentari"</li>
                            <li><strong>Riconoscimento ostacoli:</strong> "costi e tempo"</li>
                            <li><strong>Conclusione forte:</strong> "investire nella qualità di vita"</li>
                        </ul>
                    `
                }
            ],
            'articoli': [
                {
                    title: "Il Turismo Sostenibile: Una Necessità Moderna",
                    wordCount: "132 parole",
                    text: `Il turismo sostenibile rappresenta oggi una delle sfide più importanti per il settore dei viaggi, sempre più consapevole del proprio impatto ambientale e sociale.

Questa nuova forma di turismo si basa su principi fondamentali: rispetto per l'ambiente naturale, valorizzazione delle culture locali e distribuzione equa dei benefici economici. I viaggiatori responsabili scelgono strutture eco-friendly, utilizzano mezzi di trasporto a basso impatto e acquistano prodotti locali.

Numerose destinazioni stanno adottando politiche innovative. Le Cinque Terre, per esempio, hanno introdotto limiti al numero di visitatori giornalieri, mentre Costa Rica promuove l'ecoturismo come modello di sviluppo.

I benefici sono evidenti: protezione degli ecosistemi, preservazione delle tradizioni culturali e crescita economica sostenibile per le comunità locali.

Il futuro del turismo dipende dalla nostra capacità di viaggiare in modo consapevole, trasformando ogni viaggio in un'opportunità di crescita reciproca.`,
                    analysis: `
                        <h4>📊 Analisi del Testo</h4>
                        <ul>
                            <li><strong>Stile giornalistico:</strong> Informativo, oggettivo, attuale</li>
                            <li><strong>Esempi concreti:</strong> Cinque Terre, Costa Rica</li>
                            <li><strong>Dati specifici:</strong> "limiti al numero di visitatori"</li>
                            <li><strong>Linguaggio tecnico:</strong> "eco-friendly", "ecoturismo"</li>
                            <li><strong>Call to action finale:</strong> Invito alla responsabilità</li>
                        </ul>
                    `
                }
            ],
            'racconti': [
                {
                    title: "Un Incontro Che Ha Cambiato Tutto",
                    wordCount: "138 parole",
                    text: `Era una giornata grigia di novembre quando ho incontrato Elena alla fermata dell'autobus. Stava piangendo silenziosamente, con un libro di poesie tra le mani.

"Tutto bene?" le ho chiesto istintivamente. Lei mi ha guardato sorpresa, poi ha sorriso attraverso le lacrime. "È solo che questa poesia mi ricorda mia nonna", ha sussurrato mostrandomi i versi di Montale.

Abbiamo iniziato a parlare durante il viaggio. Elena studiava letteratura e aveva perso la nonna pochi mesi prima. Io, che non avevo mai apprezzato la poesia, sono rimasto affascinato dalla sua passione e dalla profondità delle sue riflessioni.

Quel giorno ho scoperto un mondo nuovo. Elena è diventata la mia migliore amica e, grazie a lei, ho imparato ad amare la letteratura. A volte basta un incontro casuale per cambiare completamente la propria prospettiva sulla vita.`,
                    analysis: `
                        <h4>📊 Analisi del Testo</h4>
                        <ul>
                            <li><strong>Ambientazione:</strong> "giornata grigia di novembre", "fermata dell'autobus"</li>
                            <li><strong>Personaggi definiti:</strong> Narratore curioso, Elena sensibile</li>
                            <li><strong>Dialoghi realistici:</strong> "Tutto bene?", "È solo che..."</li>
                            <li><strong>Evoluzione temporale:</strong> Da incontro casuale ad amicizia duratura</li>
                            <li><strong>Messaggio finale:</strong> Riflessione sul potere degli incontri casuali</li>
                        </ul>
                    `
                }
            ]
        };

        // Database delle simulazioni d'esame
        const examSimulations = [
            {
                id: 1,
                title: "Simulazione 1 - Università e lavoro",
                shortText: {
                    title: "Email al Direttore",
                    prompt: "Scrivi un'email formale al direttore della tua scuola per richiedere un certificato di frequenza. Spiega il motivo della richiesta e quando ti serve.",
                    placeholder: "Scrivi qui la tua email formale..."
                },
                longText: {
                    title: "Articolo - Shopping Online",
                    prompt: "Scrivi un articolo per un blog sui vantaggi e svantaggi dello shopping online. Presenta entrambi gli aspetti con esempi concreti.",
                    placeholder: "Scrivi qui il tuo articolo..."
                }
            },
            {
                id: 2,
                title: "Simulazione 2 - Ambiente e società",
                shortText: {
                    title: "Messaggio WhatsApp",
                    prompt: "Manda un messaggio a un amico per organizzare una giornata di pulizia del parco. Indica quando, dove incontrarsi e cosa portare.",
                    placeholder: "Scrivi qui il tuo messaggio..."
                },
                longText: {
                    title: "Tema - Trasporti Pubblici",
                    prompt: "Discuti l'importanza dei trasporti pubblici nelle città moderne. Analizza vantaggi per l'ambiente e la qualità della vita urbana.",
                    placeholder: "Scrivi qui il tuo tema..."
                }
            },
            {
                id: 3,
                title: "Simulazione 3 - Tecnologia e comunicazione",
                shortText: {
                    title: "Email di Reclamo",
                    prompt: "Scrivi al servizio clienti di un'azienda telefonica per lamentarti della cattiva qualità della connessione internet e chiedere una soluzione.",
                    placeholder: "Scrivi qui la tua email di reclamo..."
                },
                longText: {
                    title: "Articolo - Social Media",
                    prompt: "Scrivi per un giornale studentesco sull'influenza dei social media sui rapporti interpersonali tra i giovani. Presenta pro e contro.",
                    placeholder: "Scrivi qui il tuo articolo..."
                }
            },
            {
                id: 4,
                title: "Simulazione 4 - Salute e benessere",
                shortText: {
                    title: "Lettera al Medico",
                    prompt: "Scrivi una lettera formale al tuo medico per disdire un appuntamento e richiederne uno nuovo. Spiega il motivo del cambio.",
                    placeholder: "Scrivi qui la tua lettera..."
                },
                longText: {
                    title: "Tema - Alimentazione Sana",
                    prompt: "Rifletti sull'importanza di un'alimentazione equilibrata nella vita moderna. Discuti le sfide e i benefici di mangiare sano oggi.",
                    placeholder: "Scrivi qui il tuo tema..."
                }
            },
            {
                id: 5,
                title: "Simulazione 5 - Cultura e Tradizioni",
                shortText: {
                    title: "Invito Formale",
                    prompt: "Scrivi un invito formale per una mostra d'arte che stai organizzando. Includi dettagli su data, luogo e tema dell'esposizione.",
                    placeholder: "Scrivi qui il tuo invito..."
                },
                longText: {
                    title: "Racconto - Tradizione Familiare",
                    prompt: "Racconta una tradizione importante della tua famiglia o del tuo paese. Spiega perché è significativa e come viene celebrata.",
                    placeholder: "Scrivi qui il tuo racconto..."
                }
            },
            {
                id: 6,
                title: "Simulazione 6 - Viaggi e Turismo",
                shortText: {
                    title: "Email all'Hotel",
                    prompt: "Scrivi all'hotel dove hai prenotato per informarli di un ritardo nel check-in e chiedere di mantenere la prenotazione.",
                    placeholder: "Scrivi qui la tua email..."
                },
                longText: {
                    title: "Articolo - Turismo Sostenibile",
                    prompt: "Scrivi un articolo sul turismo responsabile. Spiega come viaggiare rispettando l'ambiente e le comunità locali.",
                    placeholder: "Scrivi qui il tuo articolo..."
                }
            },
            {
                id: 7,
                title: "Simulazione 7 - Educazione e Formazione",
                shortText: {
                    title: "Messaggio al Professore",
                    prompt: "Manda un messaggio al tuo professore per chiedere chiarimenti su un progetto di gruppo. Sii specifico sulle tue domande.",
                    placeholder: "Scrivi qui il tuo messaggio..."
                },
                longText: {
                    title: "Tema - Apprendimento Online",
                    prompt: "Confronta l'apprendimento tradizionale in aula con quello online. Analizza vantaggi e svantaggi di entrambi i metodi.",
                    placeholder: "Scrivi qui il tuo tema..."
                }
            },
            {
                id: 8,
                title: "Simulazione 8 - Sport e Tempo Libero",
                shortText: {
                    title: "Email alla Palestra",
                    prompt: "Scrivi alla tua palestra per sospendere temporaneamente l'abbonamento per motivi di salute. Chiedi le procedure da seguire.",
                    placeholder: "Scrivi qui la tua email..."
                },
                longText: {
                    title: "Articolo - Sport e Giovani",
                    prompt: "Scrivi per una rivista sportiva sull'importanza dell'attività fisica per i giovani. Includi benefici fisici e psicologici.",
                    placeholder: "Scrivi qui il tuo articolo..."
                }
            },
            {
                id: 9,
                title: "Simulazione 9 - Casa e Famiglia",
                shortText: {
                    title: "Lettera all'Amministratore",
                    prompt: "Scrivi all'amministratore del tuo condominio per segnalare un problema con l'ascensore e richiedere una riparazione urgente.",
                    placeholder: "Scrivi qui la tua lettera..."
                },
                longText: {
                    title: "Tema - Vita in Famiglia",
                    prompt: "Rifletti sui cambiamenti nella struttura familiare moderna. Come sono cambiate le relazioni familiari negli ultimi decenni?",
                    placeholder: "Scrivi qui il tuo tema..."
                }
            },
            {
                id: 10,
                title: "Simulazione 10 - Economia e Consumi",
                shortText: {
                    title: "Email alla Banca",
                    prompt: "Scrivi alla tua banca per richiedere informazioni su un nuovo conto corrente per studenti. Chiedi dettagli su costi e servizi.",
                    placeholder: "Scrivi qui la tua email..."
                },
                longText: {
                    title: "Articolo - Consumo Consapevole",
                    prompt: "Scrivi un articolo sui vantaggi del consumo consapevole. Spiega come le scelte d'acquisto possono influenzare l'ambiente e la società.",
                    placeholder: "Scrivi qui il tuo articolo..."
                }
            }
        ];

        function startSimulation() {
            const modal = document.getElementById('simulationModal');
            const content = document.getElementById('simulationContent');
            
            content.innerHTML = `
                <h2>🎭 Scegli la tua simulazione CILS B2</h2>
                
                <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border-radius: 15px; padding: 20px; margin: 20px 0; text-align: center;">
                    <h3 style="margin: 0 0 10px 0;">📚 10 Simulazioni Complete Disponibili</h3>
                    <p style="margin: 0; opacity: 0.9;">Ogni simulazione include 2 prove autentiche con timer di 70 minuti</p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; max-height: 400px; overflow-y: auto; padding: 10px;">
                    ${examSimulations.map(sim => `
                        <div style="background: white; border: 2px solid #e9ecef; border-radius: 12px; padding: 20px; cursor: pointer; transition: all 0.3s ease;" 
                             onclick="startSpecificSimulation(${sim.id})" 
                             onmouseover="this.style.borderColor='#667eea'; this.style.transform='translateY(-2px)'" 
                             onmouseout="this.style.borderColor='#e9ecef'; this.style.transform='translateY(0)'">
                            <h4 style="margin: 0 0 10px 0; color: #2c3e50; font-size: 1.1em;">${sim.title}</h4>
                            <div style="font-size: 0.9em; color: #7f8c8d; line-height: 1.4;">
                                <div style="margin-bottom: 8px;">
                                    <strong>📝 Breve:</strong> ${sim.shortText.title}
                                </div>
                                <div>
                                    <strong>📖 Lungo:</strong> ${sim.longText.title}
                                </div>
                            </div>
                            <div style="margin-top: 15px; text-align: center;">
                                <span style="background: #667eea; color: white; padding: 5px 12px; border-radius: 15px; font-size: 0.8em; font-weight: bold;">
                                    ⏱️ 70 min
                                </span>
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <div style="background: #f8f9fa; border-radius: 10px; padding: 15px; margin: 20px 0;">
                    <h4 style="margin: 0 0 10px 0; color: #2c3e50;">📋 Cosa include ogni simulazione</h4>
                    <ul style="margin: 0; padding-left: 20px; color: #7f8c8d; font-size: 0.9em;">
                        <li>Timer realistico di 70 minuti con allarmi visivi</li>
                        <li>Tracce autentiche basate su esami CILS reali</li>
                        <li>Contatori parole in tempo reale con feedback colorato</li>
                        <li>Valutazione automatica con punteggio dettagliato</li>
                        <li>Analisi completa delle competenze linguistiche</li>
                    </ul>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" onclick="startRandomSimulation()">🎲 Simulazione casuale</button>
                    <button class="btn btn-secondary" onclick="closeModal('simulationModal')">❌ Chiudi</button>
                </div>
            `;
            
            modal.style.display = 'flex';
        }

        function startRandomSimulation() {
            const randomId = Math.floor(Math.random() * examSimulations.length) + 1;
            startSpecificSimulation(randomId);
        }

        function startSpecificSimulation(simulationId) {
            const simulation = examSimulations.find(sim => sim.id === simulationId);
            const modal = document.getElementById('simulationModal');
            const content = document.getElementById('simulationContent');
            
            content.innerHTML = `
                <h2>🎭 ${simulation.title}</h2>
                
                <div style="background: #f093fb; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border-radius: 15px; padding: 20px; margin: 20px 0; text-align: center;">
                    <div class="timer-display" style="background: rgba(255,255,255,0.2); margin: 0;">
                        ⏰ Tempo rimanente: <span id="examTimer">70:00</span>
                    </div>
                    <p style="margin: 10px 0 0 0; font-size: 0.9em;">Simulazione in condizioni d'esame reali</p>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;" class="simulation-grid">
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px; position: relative;">
                        <h4 style="margin-top: 0;">✍️ Prova 1 - ${simulation.shortText.title} (80-100 parole)</h4>
                        <div style="background: #e8f4fd; padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 0.9em;">
                            <strong>Traccia:</strong> ${simulation.shortText.prompt}
                        </div>
                        <textarea id="examText1" style="width: 100%; height: 150px; padding: 10px; border: 2px solid #667eea; border-radius: 8px; font-family: inherit;" placeholder="${simulation.shortText.placeholder}"></textarea>
                        <div style="display: flex; justify-content: space-between; margin-top: 8px; font-size: 0.8em;">
                            <span>Parole: <span id="wordCount1" style="font-weight: bold;">0</span></span>
                            <span id="status1" style="color: #e74c3c;">Troppo breve</span>
                        </div>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 15px; position: relative;">
                        <h4 style="margin-top: 0;">📖 Prova 2 - ${simulation.longText.title} (120-140 parole)</h4>
                        <div style="background: #e8f4fd; padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 0.9em;">
                            <strong>Traccia:</strong> ${simulation.longText.prompt}
                        </div>
                        <textarea id="examText2" style="width: 100%; height: 150px; padding: 10px; border: 2px solid #667eea; border-radius: 8px; font-family: inherit;" placeholder="${simulation.longText.placeholder}"></textarea>
                        <div style="display: flex; justify-content: space-between; margin-top: 8px; font-size: 0.8em;">
                            <span>Parole: <span id="wordCount2" style="font-weight: bold;">0</span></span>
                            <span id="status2" style="color: #e74c3c;">Troppo breve</span>
                        </div>
                    </div>
                </div>
                
                <div style="background: #fff3cd; border-radius: 10px; padding: 15px; margin: 20px 0;">
                    <h4 style="margin: 0 0 10px 0; color: #856404;">📋 Istruzioni d'Esame</h4>
                    <ul style="margin: 0; padding-left: 20px; color: #856404; font-size: 0.9em;">
                        <li>Completa entrambe le prove nel tempo stabilito (70 minuti)</li>
                        <li>Rispetta i limiti di parole: 80-100 per il testo breve, 120-140 per quello lungo</li>
                        <li>Usa un registro appropriato per ogni tipologia di testo</li>
                        <li>Controlla grammatica e ortografia prima di consegnare</li>
                        <li>Struttura i testi con introduzione, sviluppo e conclusione</li>
                    </ul>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" onclick="submitSimulationAdvanced()">🎯 Consegna esame</button>
                    <button class="btn" onclick="pauseSimulation()" style="background: #f39c12;">⏸️ Pausa</button>
                    <button class="btn" onclick="startSimulation()" style="background: #6c757d;">🔄 Cambia simulazione</button>
                    <button class="btn btn-secondary" onclick="closeModal('simulationModal')">❌ Annulla</button>
                </div>
                
                <div id="simulationResults" style="display: none;"></div>
            `;
            
            modal.style.display = 'flex';
            startExamTimer();
            setupExamWordCounters();
        }

        function startExamTimer() {
            let totalSeconds = 70 * 60; // 70 minuti
            const timerElement = document.getElementById('examTimer');
            
            const examTimerInterval = setInterval(() => {
                const minutes = Math.floor(totalSeconds / 60);
                const seconds = totalSeconds % 60;
                timerElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                // Cambia colore quando mancano 10 minuti
                if (totalSeconds <= 600) {
                    timerElement.style.color = '#e74c3c';
                }
                
                if (totalSeconds <= 0) {
                    clearInterval(examTimerInterval);
                    alert('⏰ Tempo scaduto! L\'esame verrà consegnato automaticamente.');
                    submitSimulationAdvanced();
                }
                totalSeconds--;
            }, 1000);
        }

        function setupExamWordCounters() {
            document.getElementById('examText1').addEventListener('input', function() {
                updateExamWordCount(this, 'wordCount1', 'status1', 80, 100);
            });
            
            document.getElementById('examText2').addEventListener('input', function() {
                updateExamWordCount(this, 'wordCount2', 'status2', 120, 140);
            });
        }

        function updateExamWordCount(textarea, counterId, statusId, minWords, maxWords) {
            const text = textarea.value;
            const wordCount = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
            const countElement = document.getElementById(counterId);
            const statusElement = document.getElementById(statusId);
            
            countElement.textContent = wordCount;
            
            if (wordCount < minWords) {
                statusElement.textContent = 'Troppo breve';
                statusElement.style.color = '#e74c3c';
                countElement.style.color = '#e74c3c';
            } else if (wordCount > maxWords) {
                statusElement.textContent = 'Troppo lungo';
                statusElement.style.color = '#f39c12';
                countElement.style.color = '#f39c12';
            } else {
                statusElement.textContent = 'Perfetto!';
                statusElement.style.color = '#27ae60';
                countElement.style.color = '#27ae60';
            }
        }

        function submitSimulationAdvanced() {
            const text1 = document.getElementById('examText1').value;
            const text2 = document.getElementById('examText2').value;
            const wordCount1 = text1.trim() === '' ? 0 : text1.trim().split(/\s+/).length;
            const wordCount2 = text2.trim() === '' ? 0 : text2.trim().split(/\s+/).length;
            
            // Calcola punteggi
            let score1 = calculateTextScore(text1, 80, 100);
            let score2 = calculateTextScore(text2, 120, 140);
            let totalScore = Math.round((score1 + score2) / 2);
            
            const resultsDiv = document.getElementById('simulationResults');
            resultsDiv.innerHTML = `
                <div style="background: white; border-radius: 15px; padding: 25px; margin-top: 20px;">
                    <h3 style="text-align: center; color: #2c3e50; margin-bottom: 20px;">📊 Risultati simulazione</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                            <div class="score-circle" style="width: 60px; height: 60px; font-size: 1em;">
                                ${score1}/100
                            </div>
                            <h4 style="margin: 10px 0 5px 0;">Testo breve</h4>
                            <p style="margin: 0; font-size: 0.9em; color: #7f8c8d;">${wordCount1} parole</p>
                        </div>
                        
                        <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                            <div class="score-circle" style="width: 60px; height: 60px; font-size: 1em;">
                                ${score2}/100
                            </div>
                            <h4 style="margin: 10px 0 5px 0;">Testo Lungo</h4>
                            <p style="margin: 0; font-size: 0.9em; color: #7f8c8d;">${wordCount2} parole</p>
                        </div>
                    </div>
                    
                    <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border-radius: 15px;">
                        <h3 style="margin: 0 0 10px 0;">Punteggio finale: ${totalScore}/100</h3>
                        <p style="margin: 0; font-size: 1.1em;">
                            ${totalScore >= 80 ? '🎉 Eccellente! Sei pronto per l\'esame!' : 
                              totalScore >= 60 ? '👍 Buon lavoro! Continua a praticare.' : 
                              '📚 Hai bisogno di più pratica. Non mollare!'}
                        </p>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn" onclick="closeModal('simulationModal')">✅ Chiudi</button>
                        <button class="btn" onclick="showPremiumInfo()">🚀 Analisi dettagliata Premium</button>
                    </div>
                </div>
            `;
            
            resultsDiv.style.display = 'block';
        }

        function calculateTextScore(text, minWords, maxWords) {
            if (text.trim() === '') return 0;
            
            const wordCount = text.trim().split(/\s+/).length;
            const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);
            const connectives = text.match(/\b(tuttavia|inoltre|infatti|quindi|perciò|nonostante|malgrado|al contrario|invece)\b/gi) || [];
            
            let score = 0;
            
            // Lunghezza appropriata (30 punti)
            if (wordCount >= minWords && wordCount <= maxWords) {
                score += 30;
            } else if (wordCount >= minWords * 0.8 && wordCount <= maxWords * 1.2) {
                score += 20;
            } else {
                score += 10;
            }
            
            // Struttura (25 punti)
            if (sentences.length >= 3) score += 25;
            else if (sentences.length >= 2) score += 15;
            else score += 5;
            
            // Connettivi (20 punti)
            if (connectives.length >= 2) score += 20;
            else if (connectives.length >= 1) score += 10;
            
            // Punteggiatura (15 punti)
            if (text.includes(',') && text.includes('.')) score += 15;
            else if (text.includes('.')) score += 10;
            
            // Registro appropriato (10 punti)
            if (text.toLowerCase().includes('egregio') || text.toLowerCase().includes('gentile') || 
                text.toLowerCase().includes('cordiali') || text.toLowerCase().includes('distinti')) {
                score += 10;
            }
            
            return Math.min(score, 100);
        }

        function pauseSimulation() {
            alert('⏸️ Simulazione in pausa.\n\nIn un esame reale non è possibile mettere in pausa il timer.\nQuesta funzione è disponibile solo per l\'allenamento.');
        }

        // Variabili globali per funzionalità avanzate
        let writingStartTime = null;
        let timerInterval = null;
        let writingTimeInterval = null;

        function checkTextAdvanced() {
            const text = document.getElementById('writingText').value;
            const wordCount = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
            const charCount = text.length;
            const feedback = document.getElementById('feedback');
            
            if (text.trim() === '') {
                feedback.innerHTML = `
                    <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 10px;">
                        ⚠️ Scrivi qualcosa prima di controllare il testo!
                    </div>
                `;
                return;
            }

            // Analisi avanzata del testo
            const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);
            const avgWordsPerSentence = sentences.length > 0 ? (wordCount / sentences.length).toFixed(1) : 0;
            const complexWords = text.match(/\b\w{8,}\b/g) || [];
            const connectives = text.match(/\b(tuttavia|inoltre|infatti|quindi|perciò|nonostante|malgrado)\b/gi) || [];
            
            // Calcolo punteggio
            let score = 0;
            if (wordCount >= 80 && wordCount <= 140) score += 25;
            if (sentences.length >= 3) score += 20;
            if (connectives.length >= 2) score += 20;
            if (complexWords.length >= 3) score += 15;
            if (text.includes(',') && text.includes('.')) score += 20;
            
            let feedbackHTML = `
                <div class="feedback-detailed">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div class="score-circle">
                            ${score}/100
                        </div>
                        <h4 style="margin: 0; color: #2c3e50;">Valutazione complessiva</h4>
                    </div>
                    
                    <div class="feedback-section">
                        <h4>📊 Statistiche del Testo</h4>
                        <ul>
                            <li><strong>Parole:</strong> ${wordCount} (${wordCount < 80 ? 'Troppo breve' : wordCount > 140 ? 'Troppo lungo' : 'Perfetto'})</li>
                            <li><strong>Caratteri:</strong> ${charCount}</li>
                            <li><strong>Frasi:</strong> ${sentences.length}</li>
                            <li><strong>Media parole per frase:</strong> ${avgWordsPerSentence}</li>
                        </ul>
                    </div>
                    
                    <div class="feedback-section">
                        <h4>🎯 Analisi Qualitativa</h4>
                        <ul>
                            <li><strong>Connettivi trovati:</strong> ${connectives.length} (${connectives.join(', ') || 'Nessuno'})</li>
                            <li><strong>Parole complesse:</strong> ${complexWords.length} (${complexWords.slice(0,3).join(', ')}${complexWords.length > 3 ? '...' : ''})</li>
                            <li><strong>Registro:</strong> ${text.toLowerCase().includes('egregio') || text.toLowerCase().includes('gentile') ? 'Formale ✅' : text.toLowerCase().includes('ciao') ? 'Informale ✅' : 'Da verificare ⚠️'}</li>
                        </ul>
                    </div>
                    
                    <div class="feedback-section">
                        <h4>💡 Suggerimenti per migliorare</h4>
                        <ul>
                            ${wordCount < 80 ? '<li>Aggiungi più dettagli per raggiungere la lunghezza richiesta</li>' : ''}
                            ${wordCount > 140 ? '<li>Riduci il testo eliminando informazioni non essenziali</li>' : ''}
                            ${connectives.length < 2 ? '<li>Usa più connettivi per collegare meglio le idee</li>' : ''}
                            ${sentences.length < 3 ? '<li>Dividi il testo in più frasi per migliorare la leggibilità</li>' : ''}
                            ${!text.includes(',') ? '<li>Usa la punteggiatura per strutturare meglio il testo</li>' : ''}
                        </ul>
                    </div>
                </div>
                
                <div style="background: #e8f4fd; border-radius: 10px; padding: 15px; margin-top: 15px; text-align: center;">
                    <p style="margin: 0; color: #2c3e50;">
                        🚀 <strong>Vuoi un'analisi ancora più dettagliata?</strong><br>
                        Con Premium ottieni correzioni grammaticali, suggerimenti stilistici e molto altro!
                    </p>
                    <button class="btn" onclick="showPremiumInfo()" style="margin-top: 10px;">Scopri Premium</button>
                </div>
            `;
            
            feedback.innerHTML = feedbackHTML;
        }

        // Funzioni per strumenti di scrittura
        function insertConnective() {
            const connectives = [
                'tuttavia', 'inoltre', 'infatti', 'quindi', 'perciò', 'nonostante', 
                'malgrado', 'al contrario', 'invece', 'per esempio', 'in particolare'
            ];
            const randomConnective = connectives[Math.floor(Math.random() * connectives.length)];
            const textarea = document.getElementById('writingText');
            const cursorPos = textarea.selectionStart;
            const textBefore = textarea.value.substring(0, cursorPos);
            const textAfter = textarea.value.substring(cursorPos);
            textarea.value = textBefore + randomConnective + ', ' + textAfter;
            textarea.focus();
            textarea.setSelectionRange(cursorPos + randomConnective.length + 2, cursorPos + randomConnective.length + 2);
        }

        function suggestVocabulary() {
            alert('💡 Suggerimenti Vocabolario:\n\n• Invece di "bello" usa: magnifico, splendido, eccellente\n• Invece di "importante" usa: fondamentale, essenziale, cruciale\n• Invece di "dire" usa: affermare, sostenere, dichiarare\n\nPer suggerimenti personalizzati in tempo reale, prova Premium!');
        }

        function checkGrammar() {
            const text = document.getElementById('writingText').value;
            if (text.trim() === '') {
                alert('⚠️ Scrivi qualcosa prima di controllare la grammatica!');
                return;
            }
            
            let issues = [];
            if (!text.match(/[.!?]$/)) issues.push('Il testo dovrebbe terminare con un segno di punteggiatura');
            if (text.match(/\b(a|e|i|o|u)\s+\1\b/gi)) issues.push('Possibili ripetizioni di vocali consecutive');
            if (text.match(/\b(\w+)\s+\1\b/gi)) issues.push('Possibili ripetizioni di parole');
            
            if (issues.length === 0) {
                alert('✅ Nessun errore grammaticale evidente trovato!\n\nPer un controllo più approfondito, prova Premium con correzione IA!');
            } else {
                alert('⚠️ Possibili problemi trovati:\n\n• ' + issues.join('\n• ') + '\n\nPer correzioni automatiche, prova Premium!');
            }
        }

        function formatText() {
            const textarea = document.getElementById('writingText');
            let text = textarea.value;
            
            // Correzioni di formattazione base
            text = text.replace(/\s+/g, ' '); // Rimuove spazi multipli
            text = text.replace(/\s*,\s*/g, ', '); // Spazi dopo virgole
            text = text.replace(/\s*\.\s*/g, '. '); // Spazi dopo punti
            text = text.trim();
            
            // Capitalizza dopo punti
            text = text.replace(/\.\s*([a-z])/g, function(match, letter) {
                return '. ' + letter.toUpperCase();
            });
            
            // Capitalizza inizio testo
            if (text.length > 0) {
                text = text.charAt(0).toUpperCase() + text.slice(1);
            }
            
            textarea.value = text;
            alert('✨ Testo formattato! Sono stati corretti spazi, punteggiatura e maiuscole.');
        }

        function startTimer() {
            const minutes = prompt('Inserisci i minuti per il timer (es: 30 per mezz\'ora):');
            if (!minutes || isNaN(minutes) || minutes <= 0) return;
            
            const timerDisplay = document.getElementById('timerDisplay');
            const timeLeft = document.getElementById('timeLeft');
            
            let totalSeconds = parseInt(minutes) * 60;
            timerDisplay.style.display = 'block';
            
            timerInterval = setInterval(() => {
                const mins = Math.floor(totalSeconds / 60);
                const secs = totalSeconds % 60;
                timeLeft.textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                
                if (totalSeconds <= 0) {
                    clearInterval(timerInterval);
                    alert('⏰ Tempo scaduto! Controlla il tuo testo.');
                    timerDisplay.style.display = 'none';
                }
                totalSeconds--;
            }, 1000);
        }

        function saveText() {
            const text = document.getElementById('writingText').value;
            if (text.trim() === '') {
                alert('⚠️ Non c\'è niente da salvare!');
                return;
            }
            
            localStorage.setItem('cilsB2_draft_' + Date.now(), text);
            alert('💾 Bozza salvata con successo!\n\nPuoi recuperarla dalla sezione "Le mie bozze" (disponibile in Premium).');
        }

        // Funzione originale mantenuta per compatibilità
        function checkText() {
            checkTextAdvanced();
        }

        function clearText() {
            document.getElementById('writingText').value = '';
            document.getElementById('wordCounter').textContent = '0';
            document.getElementById('feedback').innerHTML = '';
        }

        function submitSimulation() {
            alert('🎉 Simulazione completata! In un esame reale, i tuoi testi sarebbero ora valutati secondo i criteri CILS ufficiali.\n\nPer simulazioni complete con cronometro e valutazione automatica, prova la versione Premium!');
            closeModal('simulationModal');
        }

        function showModelCategory(category) {
            const models = modelTexts[category];
            const contentDiv = document.getElementById('modelContent');
            
            if (!models) {
                contentDiv.innerHTML = '<p>Categoria non trovata</p>';
                return;
            }
            
            let html = `<h4>📚 ${getCategoryTitle(category)}</h4>`;
            
            models.forEach((model, index) => {
                html += `
                    <div style="background: white; border-radius: 15px; padding: 20px; margin: 20px 0; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h5 style="margin: 0; color: #2c3e50;">${model.title}</h5>
                            <span style="background: #667eea; color: white; padding: 5px 12px; border-radius: 15px; font-size: 0.8em;">
                                ${model.wordCount}
                            </span>
                        </div>
                        
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin: 15px 0; font-family: 'Georgia', serif; line-height: 1.6; white-space: pre-line;">
                            ${model.text}
                        </div>
                        
                        <div style="background: #e8f4fd; border-radius: 10px; padding: 15px; margin-top: 15px;">
                            ${model.analysis}
                        </div>
                        
                        <div style="text-align: center; margin-top: 15px;">
                            <button class="btn" onclick="copyModelText('${index}', '${category}')" style="margin: 5px;">📋 Copia Testo</button>
                            <button class="btn" onclick="analyzeModelStructure('${index}', '${category}')" style="margin: 5px;">🔍 Analizza Struttura</button>
                            <button class="btn btn-secondary" onclick="useAsTemplate('${index}', '${category}')" style="margin: 5px;">📝 Usa come Template</button>
                        </div>
                    </div>
                `;
            });
            
            contentDiv.innerHTML = html;
        }
        
        function getCategoryTitle(category) {
            const titles = {
                'email-formali': 'Email e Lettere Formali',
                'messaggi-informali': 'Messaggi Informali',
                'temi-argomentativi': 'Temi Argomentativi',
                'articoli': 'Articoli e Saggi',
                'racconti': 'Racconti Narrativi'
            };
            return titles[category] || category;
        }
        
        function copyModelText(index, category) {
            const model = modelTexts[category][index];
            navigator.clipboard.writeText(model.text).then(() => {
                alert('📋 Testo copiato negli appunti!\n\nPuoi incollarlo nell\'area di scrittura per studiarlo o modificarlo.');
            }).catch(() => {
                // Fallback per browser che non supportano clipboard API
                const textArea = document.createElement('textarea');
                textArea.value = model.text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('📋 Testo copiato negli appunti!');
            });
        }
        
        function analyzeModelStructure(index, category) {
            const model = modelTexts[category][index];
            const sentences = model.text.split(/[.!?]+/).filter(s => s.trim().length > 0);
            const paragraphs = model.text.split('\n\n').filter(p => p.trim().length > 0);
            const wordCount = model.text.trim().split(/\s+/).length;
            
            alert(`🔍 ANALISI STRUTTURALE DETTAGLIATA\n\n📊 Statistiche:\n• ${wordCount} parole totali\n• ${sentences.length} frasi\n• ${paragraphs.length} paragrafi\n• Media: ${(wordCount/sentences.length).toFixed(1)} parole per frase\n\n📝 Struttura:\n• Paragrafo 1: ${paragraphs[0] ? paragraphs[0].split(/\s+/).length : 0} parole\n• Paragrafo 2: ${paragraphs[1] ? paragraphs[1].split(/\s+/).length : 0} parole\n• Paragrafo 3: ${paragraphs[2] ? paragraphs[2].split(/\s+/).length : 0} parole\n\n💡 Questo modello rispetta perfettamente i criteri CILS B2!`);
        }
        
        function useAsTemplate(index, category) {
            const model = modelTexts[category][index];
            alert(`📝 TEMPLATE ESTRATTO\n\n"${model.title}"\n\nStruttura da seguire:\n\n1. INTRODUZIONE (${model.text.split('\n\n')[0] ? model.text.split('\n\n')[0].split(/\s+/).length : 0} parole)\n   - Presenta l'argomento\n   - Cattura l'attenzione\n\n2. SVILUPPO (${model.text.split('\n\n')[1] ? model.text.split('\n\n')[1].split(/\s+/).length : 0} parole)\n   - Argomenti principali\n   - Esempi concreti\n\n3. CONCLUSIONE (${model.text.split('\n\n')[2] ? model.text.split('\n\n')[2].split(/\s+/).length : 0} parole)\n   - Riassunto\n   - Opinione personale\n\n💡 Usa questa struttura per i tuoi testi!`);
        }

        function showPremiumInfo() {
            alert('✨ PREMIUM FEATURES:\n\n🤖 Correzione automatica con IA\n⚡ Feedback in tempo reale\n🎯 Esercizi personalizzati\n📊 Analytics dettagliati\n⏱️ Simulazioni cronometrate\n🏆 Sistema di gamificazione\n📚 Biblioteca testi modello\n👨‍🏫 Tutor virtuale 24/7\n\nUpgrade ora per sbloccare tutto!');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'987678cd84a1d6ae',t:'MTc1OTI2NDE2MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
